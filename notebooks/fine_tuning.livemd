<!-- livebook:{"persist_outputs":true} -->

# Fine-tuning with Bumblebee and Axon

```elixir
Mix.install(
  [
    {:bumblebee, "~> 0.1"},
    {:axon, path: "~/projects/axon", override: true},
    {:nx, "~> 0.4.0", override: true},
    {:exla, "~> 0.4"},
    {:explorer, "~> 0.3"}
  ],
  system_env: [
    # or cuda, tpu, rocm, etc.
    XLA_TARGET: "cpu"
  ],
  config: [
    nx: [
      default_backend: EXLA.Backend,
      default_defn_options: [compiler: EXLA]
    ]
  ]
)
```

<!-- livebook:{"output":true} -->

```
:ok
```

## Introduction

Fine-tuning is the process of specializing the parameters in a pre-trained model to a specific task. Large-language models such as BERT train on a generic langauge-modeling task which makes them powerful at extracting features from text. Despite their power, you often still need to train them on a downstream task.

This example demonstrates how to use Bumblebee and Axon to fine-tune a pre-trained Bert model to classify Yelp reviews between into classes of 1-5 stars. This example is based on [Fine-tune a pretrained model](https://huggingface.co/docs/transformers/training) from Huggingface.

You'll need to first download the Yelp Reviews dataset from the following URL:

`https://s3.amazonaws.com/fast-ai-nlp/yelp_review_full_csv.tgz`

Once downloaded, extract it to a directory of your choosing and you're ready to go!

## Load a model

We'll start by loading a pre-trained model and tokenizer; however, we'll initialize the model to have an untrained sequence classification head.

Reviews in the dataset can have anywhere from 1 to 5 stars, which means we need 5 labels in our sequence classification head. We can change the default configuration by loading the model spec with `Bumblebee.load_spec/2` and making changes to spec properties with `Bumblebee.configure/2`.

The pre-trained model we'll be using is `bert-base-cased`; however, you can use any of the supported models from the HuggingFace Hub.

```elixir
{:ok, spec} =
  Bumblebee.load_spec({:hf, "bert-base-cased"},
    architecture: :for_sequence_classification
  )

spec = Bumblebee.configure(spec, num_labels: 5)

{:ok, model} = Bumblebee.load_model({:hf, "bert-base-cased"}, spec: spec)
{:ok, tokenizer} = Bumblebee.load_tokenizer({:hf, "bert-base-cased"})
```

<!-- livebook:{"output":true} -->

```

17:39:18.148 [debug] the following parameters were missing:

  * classifier.kernel
  * classifier.bias


17:39:18.148 [debug] the following PyTorch parameters were unused:

  * cls.predictions.bias
  * cls.predictions.decoder.weight
  * cls.predictions.transform.LayerNorm.beta
  * cls.predictions.transform.LayerNorm.gamma
  * cls.predictions.transform.dense.bias
  * cls.predictions.transform.dense.weight
  * cls.seq_relationship.bias
  * cls.seq_relationship.weight


```

<!-- livebook:{"output":true} -->

```
{:ok,
 %Bumblebee.Text.BertTokenizer{
   tokenizer: #Tokenizers.Tokenizer<[
     vocab_size: 28996,
     continuing_subword_prefix: "##",
     max_input_chars_per_word: 100,
     model_type: "bpe",
     unk_token: "[UNK]"
   ]>
 }}
```

## Prepare a dataset

With the models downloaded and ready to go, you need to prepare the dataset. The downloaded dataset is a CSV. You can use the `Explorer` library to quickly load the CSV into a DataFrame.

Once the data is loaded, you need to convert raw text to tokens and the raw labels to tensors. Additionally, you need to convert the DataFrame to a Stream consisting of tuples: `{tokenized, labels}`---that is the form expected by Axon's training API.

```elixir
defmodule Yelp do
  def load(path, tokenizer, opts \\ []) do
    path
    |> Explorer.DataFrame.from_csv!(header: false)
    |> Explorer.DataFrame.rename(["label", "text"])
    |> stream()
    |> tokenize_and_batch(tokenizer, opts[:batch_size], opts[:sequence_length])
  end

  def stream(df) do
    xs = df["text"]
    ys = df["label"]

    xs
    |> Explorer.Series.to_enum()
    |> Stream.zip(Explorer.Series.to_enum(ys))
  end

  def tokenize_and_batch(stream, tokenizer, batch_size, sequence_length) do
    stream
    |> Stream.chunk_every(batch_size)
    |> Stream.map(fn batch ->
      {text, labels} = Enum.unzip(batch)
      tokenized = Bumblebee.apply_tokenizer(tokenizer, text, length: sequence_length)
      {tokenized, Nx.stack(labels)}
    end)
  end
end
```

Now you can use the `Yelp.load/2` function to load a training set and a testing set:

```elixir
batch_size = 32
sequence_length = 64

train_data =
  Yelp.load("~/yelp/yelp_review_full_csv/train.csv", tokenizer,
    batch_size: batch_size,
    sequence_length: sequence_length
  )

test_data =
  Yelp.load("~/yelp/yelp_review_full_csv/test.csv", tokenizer,
    batch_size: batch_size,
    sequence_length: sequence_length
  )
```

<!-- livebook:{"output":true} -->

```
#Stream<[
  enum: #Stream<[
    enum: #Function<73.6935098/2 in Stream.zip_with/2>,
    funs: [#Function<3.6935098/1 in Stream.chunk_while/4>]
  ]>,
  funs: [#Function<48.6935098/1 in Stream.map/2>]
]>
```

You can see what a single batch looks like by grabbing 1 from the stream:

```elixir
Enum.take(train_data, 1)
```

<!-- livebook:{"output":true} -->

```
[
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.173013>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.173012>
       [
         [101, 173, 1197, 119, 2284, 2953, 3272, 1917, 178, 1440, 1111, 1107, 170, 1704, 22351, 119, 1119, 112, 188, 3505, 1105, 3123, 1106, 2037, 1106, 1443, 1217, 10063, 4404, 132, 1119, 112, 188, 1579, 1113, 1159, 1107, 3195, 1117, 4420, 132, 1119, 112, 188, 6559, 1114, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.173014>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.53259>
     [5, 2, 4, 4, 1, 5, 5, 1, 2, 3, 1, 1, 4, 2, 5, 5, 5, 5, 5, 5, 4, 3, 2, 5, 1, 1, 1, 2, 2, 4, 2, 2]
   >}
]
```

The dataset is rather large for CPU training, so we'll just train a small subset (250 training batches and 50 testing batches):

```elixir
train_data = Enum.take(train_data, 250)
test_data = Enum.take(test_data, 50)
```

<!-- livebook:{"output":true} -->

```
[
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.181798>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.181797>
       [
         [101, 146, 1400, 112, 1207, 112, 14337, 1121, 1172, 1105, 1439, 1160, 2277, 1400, 170, 3596, 119, 146, 1261, 1139, 1610, 1106, 170, 1469, 19459, 1106, 1267, 1191, 178, 1180, 1243, 1103, 4569, 10085, 1174, 117, 1133, 1152, 1163, 1103, 2255, 146, 1125, 170, 3596, 1108, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.181799>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.69574>
     [1, 1, 1, 1, 1, 3, 2, 4, 4, 3, 2, 4, 1, 2, 4, 4, 3, 1, 1, 3, 2, 3, 2, 3, 3, 1, 2, 4, 5, 2, 4, 4]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.181833>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.181832>
       [
         [101, 1192, 1221, 1122, 112, 188, 2213, 1165, 170, 9092, 112, 188, 3370, 170, 122, 2851, 3189, 119, 119, 119, 146, 1928, 117, 5536, 131, 3839, 1104, 1366, 5363, 1625, 13305, 1165, 1195, 1301, 1106, 170, 9092, 112, 188, 119, 1109, 2006, 1553, 1104, 1280, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.181834>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.69639>
     [1, 5, 1, 1, 5, 4, 1, 2, 2, 2, 4, 2, 5, 1, 3, 2, 4, 2, 4, 3, 3, 1, 4, 4, 2, 2, 4, 1, 5, 2, 1, 4]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.181868>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.181867>
       [
         [101, 1109, 2982, 1105, 1555, 1132, 1632, 117, 1133, 1103, 7352, 1132, 22052, 2285, 106, 165, 183, 165, 183, 2240, 1821, 1113, 170, 1396, 3820, 10211, 1105, 1138, 1276, 1142, 1884, 118, 11769, 1541, 14739, 119, 1409, 1128, 1169, 1243, 1763, 1103, 7352, 117, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.181869>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.69704>
     [3, 5, 1, 4, 2, 2, 4, 2, 5, 4, 5, 5, 1, 5, 2, 5, 1, 2, 2, 4, 2, 1, 3, 5, 1, 5, 1, 4, 2, 4, 3, 2]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.181903>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.181902>
       [
         [101, 2543, 10126, 1716, 12734, 1176, 7244, 1107, 5610, 119, 1370, 109, 2539, 1114, 1103, 3172, 119, 4623, 1174, 1103, 3761, 117, 1133, 1208, 1440, 1176, 170, 5610, 1894, 19517, 119, 1302, 1716, 1113, 1103, 3091, 1105, 1263, 1113, 1103, 1171, 106, 102, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.181904>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.69769>
     [2, 4, 1, 5, 1, 4, 4, 2, 2, 1, 1, 3, 2, 5, 2, 3, 2, 5, 2, 1, 4, 2, 3, 5, 3, 3, 3, 3, 3, 3, 3, 5]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.181938>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.181937>
       [
         [101, 2038, 3821, 5999, 117, 25326, 117, 13128, 117, 1105, 3538, 106, 165, 183, 2107, 1183, 25735, 1132, 1103, 1396, 1403, 118, 1149, 3821, 1883, 14327, 117, 1103, 3821, 1883, 3676, 1113, 1113, 1988, 117, 1105, 1147, 17948, 7081, 17947, 19359, 1110, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.181939>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.69834>
     [5, 4, 3, 4, 5, 5, 1, 3, 3, 4, 2, 1, 3, 1, 3, 5, 4, 1, 2, 1, 1, 2, 2, 2, 4, 4, 2, 4, 2, 1, 1, 4]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.181973>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.181972>
       [
         [101, 6467, 1106, 3143, 1103, 165, 107, 16232, 165, 107, 153, 19123, 14964, 8388, 112, 188, 6523, 1105, 144, 11071, 1219, 1139, 1148, 3143, 1106, 5610, 117, 1133, 1211, 2620, 1209, 1178, 1301, 1171, 1191, 1139, 2053, 120, 1266, 1541, 1328, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.181974>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.69899>
     [3, 3, 3, 2, 4, 2, 5, 3, 3, 5, 3, 4, 2, 2, 2, 1, 2, 1, 5, 4, 5, 5, 3, 2, 2, 1, 1, 1, 5, 2, 2, 2]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182008>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182007>
       [
         [101, 146, 2676, 1171, 14121, 1984, 1165, 146, 1108, 170, 12141, 1107, 1344, 1278, 117, 10565, 2373, 15969, 153, 12150, 11365, 2064, 19556, 2349, 3048, 119, 1135, 1108, 7462, 1714, 5392, 3054, 1105, 1122, 1125, 1103, 6460, 117, 4824, 13507, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182009>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.69964>
     [3, 5, 2, 1, 2, 1, 1, 4, 5, 5, 2, 4, 5, 3, 4, 4, 3, 1, 2, 3, 2, 4, 4, 3, 4, 3, 4, 4, 5, 3, 2, 5]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182043>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182042>
       [
         [101, 6424, 3505, 3415, 119, 1752, 1159, 6218, 1303, 119, 9999, 1174, 1111, 1210, 6823, 119, 7043, 1108, 1113, 1103, 5612, 1837, 119, 165, 183, 165, 183, 3048, 11860, 1233, 2546, 1132, 1304, 4931, 1105, 14739, 119, 7043, 1108, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182044>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.70029>
     [4, 4, 3, 2, 2, 2, 3, 4, 1, 1, 2, 4, 3, 3, 3, 5, 5, 2, 5, 1, 5, 4, 1, 4, 2, 4, 3, 5, 4, 1, 4, 2]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182078>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182077>
       [
         [101, 1109, 2094, 2762, 112, 189, 1380, 1106, 187, 8308, 1164, 1133, 1122, 112, 188, 24525, 119, 146, 1567, 1103, 1864, 1115, 1152, 2906, 15688, 2448, 26422, 1279, 1105, 17291, 2972, 119, 146, 1138, 1178, 1151, 1106, 113, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182079>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.70094>
     [2, 3, 2, 3, 4, 3, 3, 2, 5, 3, 3, 1, 2, 1, 1, 2, 1, 5, 5, 3, 5, 3, 5, 5, 3, 2, 5, 4, 4, 1, 5, 1]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182113>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182112>
       [
         [101, 1753, 2385, 1112, 1363, 1112, 1103, 156, 18276, 18337, 2404, 2450, 117, 1133, 3613, 1555, 119, 5718, 18029, 1103, 25150, 26091, 1166, 1103, 4400, 1947, 119, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182114>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.70159>
     [3, 2, 3, 4, 2, 5, 2, 4, 5, 1, 5, 5, 5, 5, 3, 5, 5, 4, 2, 2, 4, 2, 4, 4, 2, 3, 2, 5, 1, 3, 1, 3]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182148>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182147>
       [
         [101, 1220, 1138, 1103, 1436, 16915, 1204, 2586, 10151, 19928, 1566, 117, 1177, 2750, 106, 1262, 1191, 1128, 1176, 5141, 11992, 1147, 1103, 1436, 146, 112, 1396, 1125, 1145, 119, 2543, 1104, 1139, 25735, 1132, 1103, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182149>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.70224>
     [5, 2, 2, 4, 3, 2, 3, 5, 4, 2, 5, 3, 5, 3, 1, 1, 3, 1, 1, 3, 3, 1, 3, 3, 3, 1, 4, 4, 1, 4, 4, 3]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182183>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182182>
       [
         [101, 13091, 1121, 1103, 14661, 117, 146, 1108, 17967, 1165, 146, 1276, 1142, 1282, 1120, 1147, 1393, 2450, 1107, 156, 18276, 18337, 2404, 1105, 2751, 1147, 6047, 1396, 16609, 7968, 13171, 119, 1615, 157, 7301, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182184>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.70289>
     [3, 2, 5, 1, 1, 1, 3, 3, 2, 3, 2, 4, 2, 4, 1, 3, 5, 3, 4, 4, 4, 4, 2, 2, 2, 2, 1, 4, 3, 4, 3, 4]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182218>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182217>
       [
         [101, 1109, 3448, 1110, 1662, 1106, 1525, 120, 6183, 119, 119, 119, 1103, 6300, 1867, 20590, 117, 1133, 1103, 3448, 1144, 170, 1442, 1115, 1867, 138, 9356, 120, 19179, 119, 1192, 1138, 1106, 3074, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182219>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.70354>
     [2, 1, 1, 4, 2, 3, 3, 1, 2, 5, 2, 1, 1, 4, 5, 1, 5, 2, 5, 5, 4, 4, 4, 4, 2, 3, 3, 3, 3, 4, 2, 4]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182253>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182252>
       [
         [101, 13951, 1315, 1822, 117, 1390, 1315, 4632, 117, 1136, 1242, 1234, 1656, 117, 8898, 1315, 5865, 119, 8696, 1122, 4692, 126, 109, 1198, 1106, 1243, 1107, 119, 3177, 2087, 1136, 3869, 1122, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182254>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.70419>
     [1, 1, 2, 3, 2, 4, 2, 4, 4, 2, 3, 3, 1, 3, 4, 1, 2, 1, 1, 1, 2, 3, 2, 4, 3, 3, 3, 4, 3, 2, 4, 5]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182288>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182287>
       [
         [101, 4514, 1128, 15821, 1233, 1643, 106, 1284, 1127, 1107, 1411, 5807, 1105, 1879, 1106, 2222, 1142, 1282, 1111, 5953, 1359, 1113, 1157, 1363, 3761, 119, 15821, 1233, 6206, 1127, 1268, 1113, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182289>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.70484>
     [5, 4, 2, 2, 4, 3, 2, 3, 3, 3, 5, 1, 2, 2, 2, 4, 5, 2, 3, 2, 2, 5, 5, 3, 4, 2, 3, 5, 5, 5, 3, 4]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182323>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182322>
       [
         [101, 139, 1931, 5801, 1114, 170, 6434, 8362, 1182, 2942, 5471, 1105, 12800, 7998, 119, 2189, 1190, 1103, 1141, 1265, 4387, 9352, 25453, 3263, 1225, 1136, 1505, 1176, 1103, 1143, 13447, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182324>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.70549>
     [1, 3, 3, 5, 4, 4, 2, 3, 4, 2, 4, 3, 1, 4, 2, 4, 3, 2, 3, 4, 4, 2, 3, 4, 4, 4, 1, 3, 3, 3, 1, 1]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182358>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182357>
       [
         [101, 1130, 14125, 119, 1139, 1488, 1115, 1110, 1120, 7414, 12096, 1125, 170, 16255, 1107, 1117, 15269, 119, 1109, 1825, 1120, 157, 5817, 2325, 1500, 1140, 1119, 1834, 124, 1207, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182359>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.70614>
     [1, 3, 1, 5, 4, 2, 3, 2, 4, 4, 3, 1, 4, 4, 4, 3, 4, 3, 1, 4, 5, 5, 2, 1, 3, 4, 5, 5, 1, 5, 4, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182393>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182392>
       [
         [101, 1220, 2867, 7462, 139, 9919, 1942, 24692, 1182, 1169, 3814, 106, 106, 150, 13329, 1942, 23616, 1942, 106, 106, 1693, 1193, 6315, 13976, 13976, 13976, 13976, 13976, 13976, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182394>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.70679>
     [5, 4, 4, 1, 4, 5, 5, 2, 5, 1, 2, 3, 4, 5, 3, 1, 4, 5, 5, 1, 5, 4, 3, 5, 3, 2, 5, 3, 2, 5, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182428>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182427>
       [
         [101, 1109, 16964, 8391, 1132, 13533, 106, 165, 183, 165, 183, 1942, 24679, 112, 1231, 3264, 1111, 18024, 18204, 1115, 1198, 1328, 1106, 10482, 2108, 1343, 1104, 1366, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182429>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.70744>
     [5, 3, 3, 3, 3, 3, 3, 2, 3, 4, 2, 3, 1, 3, 2, 2, 3, 1, 4, 4, 3, 4, 3, 3, 3, 4, 4, 3, 4, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182463>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182462>
       [
         [101, 13063, 3452, 3871, 117, 1133, 1122, 1110, 1579, 170, 3367, 1104, 9011, 119, 4108, 1612, 1106, 2215, 1107, 1240, 1946, 1191, 1128, 1243, 1141, 117, 1272, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182464>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.70809>
     [4, 3, 4, 3, 5, 3, 4, 2, 3, 4, 1, 4, 1, 3, 5, 2, 1, 2, 4, 5, 2, 2, 2, 3, 3, 2, 4, 5, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182498>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182497>
       [
         [101, 146, 1522, 1146, 1113, 10046, 25676, 1317, 194, 1733, 2403, 1133, 1108, 1107, 1103, 4532, 2052, 119, 146, 1464, 1176, 4112, 1111, 5953, 119, 17508, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182499>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.70874>
     [4, 4, 4, 3, 4, 3, 3, 1, 4, 3, 2, 5, 1, 4, 1, 1, 2, 3, 4, 3, 4, 5, 4, 3, 2, 1, 2, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182533>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182532>
       [
         [101, 23330, 146, 1156, 1660, 1142, 1282, 1300, 2940, 117, 1133, 1113, 1103, 1796, 1104, 1103, 2984, 1122, 2231, 1115, 1175, 1110, 170, 16443, 4688, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182534>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.70939>
     [3, 2, 4, 4, 3, 4, 3, 1, 1, 1, 4, 1, 5, 5, 4, 4, 4, 2, 2, 3, 1, 3, 4, 1, 1, 3, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182568>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182567>
       [
         [101, 5268, 1541, 1110, 170, 8876, 113, 1463, 1199, 1614, 1132, 1160, 1111, 170, 8876, 114, 119, 146, 1354, 146, 1547, 1321, 170, 11424, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182569>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.71004>
     [3, 3, 3, 2, 2, 4, 5, 3, 3, 2, 3, 2, 4, 2, 2, 3, 5, 1, 1, 4, 4, 2, 3, 3, 3, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182603>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182602>
       [
         [101, 146, 1108, 170, 9125, 8132, 1104, 1142, 22314, 8355, 157, 5817, 1146, 1235, 1142, 1989, 119, 1220, 2125, 170, 4829, 1111, 1143, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182604>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.71069>
     [1, 3, 3, 2, 1, 1, 2, 2, 4, 1, 3, 3, 4, 5, 3, 5, 1, 1, 2, 1, 3, 1, 4, 4, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182638>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182637>
       [
         [101, 2066, 1125, 170, 144, 16941, 1161, 1942, 2541, 1303, 119, 119, 119, 146, 1108, 7089, 1120, 117, 11118, 1120, 117, 2542, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182639>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.71134>
     [4, 2, 3, 3, 4, 4, 3, 1, 1, 3, 1, 2, 1, 2, 4, 4, 3, 5, 5, 4, 4, 3, 1, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182673>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182672>
       [
         [101, 19415, 1199, 2053, 1303, 1111, 8898, 1120, 1103, 2927, 117, 1134, 1110, 19196, 1193, 1353, 1105, 1136, 10891, 1111, 2114, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182674>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.71199>
     [3, 1, 3, 4, 2, 2, 5, 5, 4, 5, 3, 1, 4, 1, 1, 2, 2, 3, 5, 2, 1, 1, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182708>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182707>
       [
         [101, 138, 10124, 1336, 1129, 1618, 23812, 1190, 1639, 1133, 1128, 112, 1325, 1243, 1184, 1128, 2653, 1111, 119, 1422, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182709>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.71264>
     [1, 1, 5, 4, 2, 3, 3, 1, 4, 2, 2, 3, 5, 3, 3, 1, 4, 4, 4, 4, 5, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182743>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182742>
       [
         [101, 8762, 2712, 1282, 119, 14303, 1301, 1267, 118, 22245, 4605, 118, 16972, 21986, 3048, 151, 143, 27073, 2162, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182744>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.71329>
     [5, 4, 1, 1, 1, 1, 2, 2, 3, 2, 4, 4, 5, 4, 5, 2, 1, 5, 5, 4, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182778>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182777>
       [
         [101, 2119, 1189, 28117, 5933, 117, 1136, 5865, 132, 1579, 4489, 119, 6424, 4931, 1234, 1105, 146, 2140, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182779>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.71394>
     [4, 2, 5, 3, 5, 5, 5, 4, 5, 1, 2, 2, 3, 2, 1, 1, 3, 1, 4, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182813>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182812>
       [
         [101, 1422, 1148, 113, 1105, 1314, 114, 2541, 1114, 5512, 112, 188, 1108, 1126, 5426, 2541, 119, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182814>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.71459>
     [1, 3, 3, 2, 1, 3, 3, 4, 3, 5, 3, 1, 5, 4, 4, 4, 4, 4, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182848>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182847>
       [
         [101, 23330, 5298, 4557, 117, 21534, 2927, 2094, 113, 1463, 146, 1821, 170, 2113, 1104, 170, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182849>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.71524>
     [3, 5, 5, 5, 5, 4, 1, 3, 2, 4, 3, 3, 1, 1, 5, 1, 3, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182883>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182882>
       [
         [101, 11993, 1293, 1376, 1355, 1154, 1139, 15027, 23417, 5878, 117, 146, 112, 182, 1136, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182884>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.71589>
     [2, 5, 1, 2, 5, 2, 5, 4, 1, 1, 4, 3, 4, 5, 5, 3, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182918>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182917>
       [
         [101, 1448, 1104, 1103, 1167, 165, 107, 4457, 4931, 165, 107, 8715, 118, 7135, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182919>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.71654>
     [4, 2, 4, 3, 4, 3, 4, 4, 1, 2, 2, 1, 4, 2, 1, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182953>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182952>
       [
         [101, 1284, 3523, 1303, 1111, 1103, 2793, 6343, 2977, 1105, 9916, 14147, 119, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182954>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.71719>
     [2, 3, 1, 2, 5, 1, 3, 1, 4, 5, 4, 5, 4, 4, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182988>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182987>
       [
         [101, 146, 1274, 112, 189, 1221, 1184, 3333, 1106, 9800, 21670, 136, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.182989>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.71784>
     [1, 2, 2, 4, 3, 3, 4, 1, 3, 2, 3, 2, 4, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183023>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183022>
       [
         [101, 1135, 1108, 170, 6434, 2541, 1107, 1451, 1936, 1236, 119, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183024>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.71849>
     [1, 4, 3, 2, 3, 5, 4, 3, 3, 4, 4, 4, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183058>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183057>
       [
         [101, 1109, 138, 5301, 2444, 2057, 1110, 1632, 1111, 4067, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183059>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.71914>
     [4, 2, 3, 5, 3, 4, 1, 2, 4, 2, 1, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183093>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183092>
       [
         [101, 1753, 1363, 119, 6502, 119, 146, 1169, 1243, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183094>
       [
         [0, 0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.71979>
     [1, 5, 2, 5, 2, 2, 5, 5, 4, 5, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183128>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183127>
       [
         [101, 1135, 1108, 1275, 131, 2532, 4306, 2106, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183129>
       [
         [0, 0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.72044>
     [3, 2, 5, 3, 3, 2, 5, 2, 5, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183163>
       [
         [1, 1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183162>
       [
         [101, 1188, 3189, 1110, 2871, 1359, 1113, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183164>
       [
         [0, 0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.72109>
     [5, 5, 1, 2, 4, 5, 1, 4, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183198>
       [
         [1, 1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183197>
       [
         [101, 12632, 8073, 112, 188, 2136, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183199>
       [
         [0, 0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.72174>
     [5, 2, 1, 1, 4, 3, 5, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183233>
       [
         [1, 1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183232>
       [
         [101, 20394, 4490, 1643, 1105, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183234>
       [
         [0, 0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.72239>
     [2, 2, 2, 2, 1, 2, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183268>
       [
         [1, 1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183267>
       [
         [101, 10605, 5658, 18122, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183269>
       [
         [0, 0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.72304>
     [5, 5, 3, 1, 2, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183303>
       [
         [1, 1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183302>
       [
         [101, 6819, 1113, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183304>
       [
         [0, 0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.72369>
     [4, 1, 4, 3, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183338>
       [
         [1, 1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183337>
       [
         [101, 146, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183339>
       [
         [0, ...],
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.72434>
     [4, 3, 1, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183373>
       [
         [1, 1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183372>
       [
         [101, ...],
         ...
       ]
     >,
     "token_type_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183374>
       [
         ...
       ]
     >
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.72499>
     [2, 5, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183408>
       [
         [1, ...],
         ...
       ]
     >,
     "input_ids" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183407>
       [
         ...
       ]
     >,
     ...
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.72564>
     [5, ...]
   >},
  {%{
     "attention_mask" => #Nx.Tensor<
       s64[32][64]
       EXLA.Backend<host:0, 0.446408219.3910270999.183443>
       [
         ...
       ]
     >,
     ...
   },
   #Nx.Tensor<
     s64[32]
     EXLA.Backend<host:0, 0.446408219.3910795284.72629>
     [...]
   >},
  {%{...}, ...},
  {...}
]
```

## Train the model

Now we can go about training the model! First, we need to extract the Axon model and parameters from the Bumblebee model map:

```elixir
%{model: model, params: params} = model
```

<!-- livebook:{"output":true} -->

```
%{
  model: #Axon<
    inputs: %{"attention_head_mask" => {12, 12}, "attention_mask" => {nil, nil}, "input_ids" => {nil, nil}, "position_ids" => {nil, nil}, "token_type_ids" => {nil, nil}}
    outputs: "container_25"
    nodes: 698
  >,
  params: %{
    "bert.encoder.layer.1.attention.output.dense" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53010>
        [-0.06566482782363892, -0.008707117289304733, -0.0845135897397995, -0.020480215549468994, 0.04589593783020973, -0.06620211154222488, 0.08160918951034546, -0.16965515911579132, -0.026551326736807823, 0.05329301953315735, 0.08026561141014099, 0.06239035725593567, 0.002561895176768303, 0.030647240579128265, -0.04097076877951622, 0.004107465967535973, 0.09066040068864822, -0.07060952484607697, 0.11948811262845993, -0.026210607960820198, 0.014282472431659698, 0.0193380918353796, -0.035722341388463974, 0.02859136462211609, -0.1644166111946106, -0.09220562875270844, -0.03942738100886345, -0.14746086299419403, 0.007020005490630865, 0.06434809416532516, 0.026131313294172287, 0.028572166338562965, -0.0010600421810522676, -0.06340516358613968, 0.011741230264306068, -0.03376394510269165, -0.1702037900686264, 0.03057749941945076, -0.22647880017757416, -0.11568421125411987, -0.036683209240436554, 0.0939934253692627, 0.025417713448405266, 0.00702311797067523, 0.027023920789361, 0.009398059919476509, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[768][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53011>
        [
          [0.04298923909664154, -0.015960872173309326, 0.022758951410651207, 0.005143297836184502, 0.0490451455116272, 1.1216608982067555e-4, -0.04557010903954506, 0.03818581625819206, 0.006103646010160446, 0.04383087158203125, 0.0032397336326539516, 0.022171098738908768, -0.0023303101770579815, 0.034987155348062515, -0.028728511184453964, -0.0656636655330658, -0.030749479308724403, 0.02143702283501625, 0.017968187108635902, 0.03376732021570206, 0.01561232190579176, -0.024693487212061882, 0.04163908213376999, -0.028910985216498375, -0.031485430896282196, 0.03834030032157898, -0.007546935696154833, 7.304698810912669e-4, -0.012324471957981586, 0.0036132577806711197, 0.015709027647972107, 0.021145913749933243, -0.01013441476970911, 0.02364479936659336, -0.02315456233918667, -0.021992076188325882, -0.032157257199287415, -0.05178891494870186, -0.04548012465238571, 0.003512770403176546, 0.024305419996380806, -0.047964852303266525, 0.004149179439991713, -3.4527582465671003e-4, -0.030440010130405426, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.8.output.LayerNorm" => %{
      "beta" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53164>
        [-0.06575392186641693, 0.04546789824962616, -0.006559896748512983, -0.12012889236211777, 0.02165943756699562, -0.07130330801010132, 0.05273422226309776, -0.09435214847326279, -0.05839898809790611, 0.028387706726789474, -0.09538926929235458, -0.022173788398504257, -0.011388073675334454, 0.05658913031220436, -0.05587577819824219, -0.05983743444085121, -0.034370601177215576, -0.00919890496879816, -0.014069286175072193, 0.031433023512363434, -0.05789126455783844, -0.045392051339149475, -0.05099766328930855, -0.06477396935224533, -0.02410719357430935, -0.03161825239658356, -0.09318286180496216, -0.190912663936615, -0.03292021527886391, -0.06510550528764725, -0.05203160271048546, 0.0318809375166893, 0.04726574942469597, -0.00832667201757431, -0.14451812207698822, -0.056312862783670425, 0.03980471193790436, -0.03481951355934143, -0.05924550071358681, -0.14909225702285767, -0.005171448457986116, 0.030776100233197212, -0.07422129064798355, -0.043314218521118164, -0.00275617279112339, ...]
      >,
      "gamma" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53165>
        [0.9116969108581543, 0.9361952543258667, 0.9298527836799622, 0.9073919057846069, 0.9444758296012878, 0.9322192072868347, 0.8779821395874023, 0.9230013489723206, 0.9324527382850647, 0.9285308122634888, 0.9401451945304871, 0.9388471841812134, 0.9418544769287109, 0.9584587216377258, 0.9417376518249512, 0.9216574430465698, 0.9349578022956848, 0.9385244250297546, 0.9376779794692993, 0.940201997756958, 0.9286911487579346, 0.9402986168861389, 0.9202149510383606, 0.9294232726097107, 0.953745424747467, 0.9202030897140503, 0.9345563054084778, 0.8693521022796631, 0.9415006041526794, 0.9352116584777832, 0.9444996118545532, 0.9167795777320862, 0.9281696081161499, 0.912575900554657, 0.9224421381950378, 0.9387171268463135, 0.9215201735496521, 0.9382527470588684, 0.9255896806716919, 0.8801986575126648, 0.9285053610801697, 0.9465542435646057, 0.8940356969833374, 0.9468579292297363, ...]
      >
    },
    "bert.encoder.layer.7.output.dense" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53150>
        [0.11505764722824097, -0.07869187742471695, -0.1058942973613739, 0.1547946035861969, -0.01660788059234619, -0.03609156981110573, 0.03061770461499691, 0.06963954865932465, -0.0012069575022906065, -0.0585361123085022, 0.037846844643354416, -0.05087948217988014, -0.0365644209086895, -0.0647248849272728, 0.0968819111585617, 0.06940620392560959, -0.06000799685716629, -0.07135278731584549, -0.048595670610666275, -0.15615350008010864, 0.05667039379477501, 0.02981288731098175, -0.009022125042974949, -0.02724636346101761, -0.0982002466917038, -0.07636988162994385, 0.03420767933130264, 0.08836417645215988, 0.00385473039932549, 0.11049231886863708, 0.030907193198800087, -0.11033991724252701, 0.03948567435145378, -0.20676885545253754, 0.10774536430835724, 0.01751483604311943, -0.06893420964479446, 0.010988465510308743, 0.10577903687953949, 0.1402784138917923, -0.0036474827211350203, -0.01244647428393364, -0.024271249771118164, -0.07189571857452393, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[3072][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53151>
        [
          [0.08152687549591064, -0.008047918789088726, -0.06973224133253098, -0.07371504604816437, -0.03325223922729492, 0.04523671045899391, 0.022211989387869835, -0.0125730624422431, 0.052841972559690475, 0.039440613240003586, 0.02279326133430004, 0.051739614456892014, -0.016856081783771515, 0.06526421010494232, 0.020937364548444748, 0.08471626043319702, -0.05280468985438347, 0.02100604772567749, -0.02500884234905243, -0.03004159778356552, -0.04893031716346741, 0.035628024488687515, 0.053006164729595184, 0.07617925107479095, 0.059252530336380005, -0.06280194222927094, -0.04684355482459068, 0.034563325345516205, 7.558114011771977e-4, -0.02998369373381138, 0.0021472007501870394, 0.035739701241254807, -0.030665593221783638, -3.3521722070872784e-4, -0.029847953468561172, -0.006205621641129255, -0.011000246740877628, -0.023556333035230637, -0.057733699679374695, 0.10756287723779678, -0.022446155548095703, 0.03263302892446518, -0.04872072488069534, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.11.attention.output.dense" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53042>
        [-0.09547267109155655, 0.012303206138312817, 0.026861658319830894, -0.019579235464334488, 0.07346626371145248, 0.013459510169923306, 0.02549632079899311, -0.0019038676982745528, -0.09368638694286346, 0.05904160067439079, 0.02500203065574169, 0.05726611986756325, 0.08931126445531845, 0.06121602654457092, 0.06489495187997818, -0.03721420839428902, -0.016536245122551918, -0.00867057591676712, -0.048027921468019485, 0.07685142010450363, 0.059483133256435394, 0.03556564822793007, -0.05798787996172905, -0.05302659049630165, 0.055721528828144073, -0.017074523493647575, -0.0413840226829052, -0.013495495542883873, 0.09561865031719208, 0.004463127348572016, 0.006091299466788769, -0.0920594334602356, 0.08573850244283676, 0.027367571368813515, 0.01786857843399048, -0.07313992828130722, 0.005926311947405338, 0.055014461278915405, 0.0165706779807806, -0.017610687762498856, 0.048756495118141174, -0.04787278547883034, -0.06708920001983643, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[768][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53043>
        [
          [-0.05536644905805588, -0.011555162258446217, -0.020413432270288467, 0.02201632224023342, 0.018595362082123756, -0.030799221247434616, 0.00764826126396656, 0.054477933794260025, -0.028939172625541687, 0.02358001284301281, 0.015347208827733994, 0.0475827120244503, -0.044972214847803116, -0.005611069966107607, -0.005388150457292795, 0.036011166870594025, -0.05006222799420357, -0.01630622334778309, -0.03808095306158066, 0.06843893229961395, 0.0011612760135903955, 0.04177016764879227, -0.05006979778409004, 0.02068684808909893, -0.04057204723358154, -0.010466042906045914, 0.061005331575870514, 0.0015786144649609923, -0.032789863646030426, -0.05699141323566437, 0.026409178972244263, -0.025645343586802483, 0.037744004279375076, 0.06727878749370575, -0.014051458798348904, -7.276454707607627e-4, 0.02120942994952202, 0.04851137846708298, 0.0358499214053154, -0.03745429217815399, 0.013667373917996883, -0.05199524015188217, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.9.attention.self.query" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53174>
        [0.08891567587852478, 0.022664887830615044, 0.07304127514362335, -0.02631675824522972, 0.00569951394572854, -0.2918471395969391, -0.26409465074539185, -0.0691170021891594, -0.18690024316310883, -0.010484450496733189, 0.29211628437042236, 0.13614942133426666, 0.051113806664943695, -0.0697275847196579, 0.20978756248950958, -0.055985670536756516, 0.029740851372480392, 0.03441271930932999, -0.32268401980400085, -0.08368425816297531, 0.06952189654111862, -0.11063841730356216, -0.12686288356781006, -0.01805269345641136, -0.0076093124225735664, 0.04083545506000519, 0.0983075350522995, 0.08028485625982285, -0.0047728377394378185, -0.1540067344903946, 0.031337667256593704, -0.055609460920095444, -0.04947463050484657, -0.035394735634326935, 0.10890162736177444, 0.12272422760725021, -0.08864200115203857, 0.30364158749580383, -0.05206092447042465, 0.11227960139513016, -0.12119248509407043, -0.08924473822116852, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[768][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53175>
        [
          [-0.013544319197535515, -0.02557787485420704, 0.00814006756991148, 0.01836344413459301, -0.004615585319697857, -0.0131912212818861, -0.04251328483223915, -0.0012511549284681678, 0.02130076475441456, 0.05191078782081604, 0.05670791491866112, 0.03704916685819626, 0.09309808164834976, 0.02992013841867447, -0.007012522779405117, 0.00931341852992773, -0.004550731275230646, -0.07913725078105927, 0.040285103023052216, -0.06027994304895401, 0.05486548691987991, -0.05735771358013153, 0.006805093958973885, -0.03216048330068588, -0.07647395133972168, 9.841104038059711e-4, 0.02875664085149765, 0.06808176636695862, 0.003425592789426446, 0.038680460304021835, -0.07167667150497437, -0.04841355234384537, 0.04274512082338333, 0.0036654213909059763, 0.058411501348018646, -0.01055786944925785, 0.0034230987075716257, 0.019237758591771126, -0.016870610415935516, -0.048422250896692276, 0.10587451606988907, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.11.output.dense" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53054>
        [0.1025182455778122, -0.06157022342085838, 0.03133787587285042, 0.06669377535581589, -0.06178940087556839, -0.007280465681105852, -0.04173581674695015, 0.008573147468268871, 0.023473963141441345, -0.12151172012090683, -0.030530910938978195, -0.03139453008770943, -0.07042105495929718, -0.02815890870988369, -0.053877782076597214, 0.025837555527687073, 0.05769309401512146, 0.05362606793642044, 0.03476198390126228, -0.01647898182272911, -0.00891895405948162, 0.009106784127652645, 0.06487550586462021, -0.0010706271277740598, -0.036536552011966705, -0.026245858520269394, 0.07996028661727905, 0.02706492878496647, -0.07389523833990097, 0.059090808033943176, 0.04138782620429993, 0.06656156480312347, -0.09974625706672668, -0.04413062334060669, -0.05499439314007759, 0.0034323667641729116, -0.018326573073863983, -0.029680287465453148, 0.010107678361237049, 0.07771310210227966, -0.09142562001943588, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[3072][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53055>
        [
          [0.02673955075442791, -0.00527998898178339, -0.049723777920007706, -0.023766374215483665, 0.0030149430967867374, 0.004704541526734829, 0.05478915572166443, -0.00916708167642355, 0.013657902367413044, 0.07237451523542404, -0.07047998160123825, -0.037325482815504074, 0.04930771514773369, 0.08272897452116013, -0.01394596230238676, 0.028921237215399742, -0.02787100523710251, -0.012683759443461895, -0.002283697947859764, 0.02200016751885414, -0.05940839648246765, -0.03352672606706619, -0.024164587259292603, 0.009632343426346779, 0.005167066585272551, 0.012752518057823181, -0.012822655960917473, 0.008536063134670258, 0.055153023451566696, 0.018973438069224358, -0.02076149731874466, 0.0054372502490878105, -0.007575021591037512, -0.026474926620721817, -0.007549113128334284, 0.033351682126522064, 0.012707643210887909, 0.02370169758796692, 0.004327010829001665, -0.03171376883983612, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.9.attention.self.key" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53172>
        [-0.0012277300702407956, 0.003720709355548024, -0.00129328656475991, -0.0051803323440253735, 1.0611673496896401e-4, 0.005625511985272169, 4.111198359169066e-5, -0.010870075784623623, -9.76770417764783e-4, -0.002780391601845622, -9.629103005863726e-4, 0.0022547924891114235, 0.007980303838849068, -0.0012966457288712263, -5.804297979921103e-4, 0.0024944620672613382, 3.6624344647862017e-4, 0.003071327693760395, -0.00559323001652956, -4.319594008848071e-4, 0.0023323544301092625, 0.008346643298864365, -0.0014766671229153872, 6.443564780056477e-4, 0.0073015945963561535, 0.0036599524319171906, -0.010229356586933136, -4.490746068768203e-4, -0.003706873394548893, 0.0129590705037117, 0.0016990624135360122, -2.2907168022356927e-4, -0.002332572126761079, -4.3019863369408995e-5, 0.0029009701684117317, -0.0026896861381828785, 0.00607977295294404, -8.272519335150719e-4, -0.0045276484452188015, -0.0033623790368437767, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[768][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53173>
        [
          [0.06799652427434921, -0.03826957195997238, -0.00369765586219728, 0.05701894313097, 0.015092210844159126, 0.055458445101976395, -0.041894905269145966, 0.054162781685590744, -0.01712600141763687, 0.03163179010152817, -0.02586505375802517, 0.0026986522134393454, -0.05528580769896507, 0.013909745961427689, 0.008139311335980892, 0.010893556289374828, -0.05451422184705734, -0.008963478729128838, -0.004695319104939699, -0.06105302646756172, 0.08329814672470093, 0.025314098224043846, -0.01559990644454956, 0.037015415728092194, -0.03337543085217476, -0.021309586241841316, 0.041092678904533386, -0.03720404580235481, 0.05297604948282242, -0.04393433779478073, -0.03974797949194908, -0.016023142263293266, -0.08329129964113235, -0.0470782145857811, 0.034112218767404556, 0.00367494928650558, -0.03381379693746567, 0.012939759530127048, 0.057220056653022766, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.6.intermediate.dense" => %{
      "bias" => #Nx.Tensor<
        f32[3072]
        EXLA.Backend<host:0, 0.446408219.3910795284.53130>
        [-0.031066125258803368, -0.04012584313750267, -0.06828667223453522, -0.0879521295428276, -0.03708360344171524, -0.02388259582221508, -0.029725616797804832, -0.08499128371477127, -0.05538780614733696, -0.03140787407755852, 0.037432197481393814, -0.1746913492679596, -0.04537739232182503, -0.023645859211683273, -0.06693693995475769, -0.12277919054031372, -0.06107555702328682, -0.06580325216054916, -0.05420130118727684, -0.09638161212205887, -0.1262163370847702, -0.02406737208366394, -0.1317615658044815, -0.04141191393136978, -0.09710217267274857, -0.08224129676818848, -0.09587938338518143, -0.060178689658641815, -0.15096083283424377, -0.10759685188531876, -0.054257869720458984, -0.09960339218378067, -0.0674409493803978, -0.0694807693362236, -0.09407998621463776, -0.18055224418640137, -0.0750889927148819, -0.09020780026912689, -0.121469646692276, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[768][3072]
        EXLA.Backend<host:0, 0.446408219.3910795284.53131>
        [
          [0.018810559064149857, -0.018457045778632164, -0.007058252114802599, 0.03952602297067642, 0.017032725736498833, 0.013379884883761406, -0.004348578862845898, 0.11247763782739639, -0.020571470260620117, -0.04511002451181412, -0.0037632558960467577, -0.05143940448760986, -0.01682334579527378, -0.040692802518606186, -0.028211085125803947, 0.042025160044431686, -0.10711807757616043, -0.030332984402775764, -0.04344969987869263, 0.06728719919919968, -0.026944302022457123, -7.53614294808358e-4, 0.036566559225320816, -0.11053591966629028, -0.024188552051782608, -0.02259409800171852, -0.049807485193014145, -0.062098585069179535, 0.05918211489915848, 0.03340630605816841, -0.061400458216667175, -0.015519828535616398, 0.041214752942323685, 0.031025756150484085, 0.02020828053355217, -0.055224109441041946, 0.020103858783841133, -0.03955547511577606, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.10.attention.self.value" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53032>
        [-0.0027987267822027206, 0.02010466530919075, 0.012401443906128407, 0.0050390055403113365, 0.005671236198395491, -0.01492128986865282, 0.0021121217869222164, -0.017947351559996605, 0.01892060413956642, -0.0038809776306152344, 0.002643166808411479, -0.017479900270700455, -0.0010772573295980692, -0.00429762527346611, -6.309093441814184e-4, -0.012759179808199406, 0.01132048387080431, -0.001142081106081605, 0.011856107972562313, -0.0045246221125125885, 0.010707388631999493, 0.013724379241466522, 0.004509288817644119, -0.0052849422208964825, 0.007526203989982605, 0.005965408869087696, -0.0042137689888477325, 0.01090355683118105, 0.008618083782494068, -0.0033106752671301365, 0.006855228915810585, 0.006143169477581978, 0.007645945996046066, -0.019885512068867683, -0.0038634336087852716, 0.0035270957741886377, -0.004787892568856478, -0.004662941675633192, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[768][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53033>
        [
          [-0.0035872904118150473, -0.023391220718622208, -0.051870279014110565, 0.012280277907848358, -0.023330122232437134, 0.015303900465369225, -0.0018847156316041946, 0.013769020326435566, 0.0033605224452912807, 0.03020133636891842, -0.017202673479914665, -0.019710876047611237, -0.025594668462872505, 0.022314684465527534, -0.053939465433359146, -0.011682949960231781, 0.013623937033116817, 0.004417371936142445, -0.03298238664865494, 0.021093137562274933, -0.03253861144185066, 2.850116288755089e-4, -0.022689281031489372, -0.013418162241578102, -0.05126265063881874, 0.03592870011925697, 0.0010664742439985275, -0.038318946957588196, -0.11607785522937775, -0.0083351144567132, 0.024687064811587334, -0.06025012582540512, -0.0442974679172039, -0.020804060623049736, -0.0035995703656226397, 0.011583867482841015, -0.049715299159288406, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.0.intermediate.dense" => %{
      "bias" => #Nx.Tensor<
        f32[3072]
        EXLA.Backend<host:0, 0.446408219.3910795284.53002>
        [-0.07296440750360489, -0.06445939093828201, -0.059890080243349075, -0.12121544033288956, -0.08548948168754578, -0.11003097146749496, -0.0636589303612709, -0.11689034849405289, -0.05199141055345535, -0.1112767681479454, -0.10020172595977783, -0.09317130595445633, -0.08610177040100098, -0.08775869756937027, -0.038828518241643906, -0.07998398691415787, -0.08563660830259323, -0.0738433450460434, -0.10874387621879578, -0.04816540330648422, -0.006356717087328434, -0.05752478539943695, -0.05281384289264679, -0.07208052277565002, -0.09714383631944656, -0.0878196582198143, -0.036292389035224915, -0.11978814750909805, -0.0629056841135025, -0.08088719099760056, -0.028502028435468674, -0.04445493593811989, -0.05218581482768059, -0.06718795746564865, -0.07850451022386551, -0.058374036103487015, -0.03895321488380432, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[768][3072]
        EXLA.Backend<host:0, 0.446408219.3910795284.53003>
        [
          [0.0065772454254329205, 0.04108882322907448, -0.03281818702816963, 0.008555825799703598, 0.010234647430479527, -0.02392038330435753, -0.1065320372581482, -0.010086340829730034, -0.0073881191201508045, 0.011685476638376713, -0.023494064807891846, 0.030191564932465553, -4.096882767044008e-4, 0.028336714953184128, 0.0038644089363515377, -0.026758715510368347, -0.025093482807278633, -0.04976030811667442, 0.003847980871796608, 0.039454080164432526, -0.024432625621557236, -0.014210399240255356, 0.0022263454739004374, -0.004987919703125954, 0.006018650718033314, 0.018050679937005043, -0.010977515019476414, 0.01605820283293724, 0.027264151722192764, -0.052236657589673996, 0.03629845753312111, -0.09512950479984283, -0.07135427743196487, 0.03560855612158775, 0.028052976354956627, 0.03334074839949608, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.6.attention.output.LayerNorm" => %{
      "beta" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53120>
        [0.003987408708781004, -0.11419127881526947, -0.15738573670387268, 0.11446991562843323, -0.07843338698148727, 0.020862724632024765, -0.19325672090053558, 0.12198849767446518, 0.09116954356431961, -0.05430812016129494, 0.05897317826747894, -0.01889214478433132, -0.06828510761260986, -0.13425619900226593, 0.010929657146334648, 0.16321006417274475, 0.007215485908091068, -0.06660326570272446, -0.13561947643756866, -0.06594768166542053, 0.03994668647646904, 0.06351406127214432, 0.011062946170568466, 0.04687263444066048, -0.106145940721035, 0.04529867693781853, 0.07913871854543686, 0.17558947205543518, 0.06591180711984634, -0.007671947591006756, -0.058879248797893524, -0.029070483520627022, -0.10518522560596466, -0.04172933101654053, 0.014925256371498108, 0.042362429201602936, ...]
      >,
      "gamma" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53121>
        [0.9204148650169373, 0.9262041449546814, 0.9261325597763062, 0.9185824394226074, 0.9316157102584839, 0.8950876593589783, 0.8630943894386292, 0.8702915906906128, 0.9385846257209778, 0.8557608127593994, 0.9737520217895508, 0.9544659852981567, 0.9758061766624451, 0.9569119215011597, 0.9460108876228333, 0.8045400977134705, 0.8868744969367981, 0.9152277708053589, 0.9012234210968018, 0.9211927652359009, 0.8738744854927063, 0.9808184504508972, 0.8972353339195251, 0.9086110591888428, 0.8974159955978394, 0.9342196583747864, 0.9429532885551453, 0.9567787647247314, 0.9275925159454346, 0.938223659992218, 0.9355992674827576, 0.8219888210296631, 0.9515662789344788, 0.840426504611969, 0.8985838890075684, ...]
      >
    },
    "bert.encoder.layer.3.attention.self.key" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53076>
        [-4.464524972718209e-4, 0.0010984160471707582, 0.0018406268209218979, 4.244840529281646e-4, -0.002628706395626068, -0.0019823487382382154, -9.488757932558656e-4, 5.746791139245033e-4, 0.0014188349014148116, 0.0018782141851261258, -0.0010109031572937965, -8.79597500897944e-4, 3.003717865794897e-4, 6.690295995213091e-4, -3.961938200518489e-4, -7.11255066562444e-4, 2.0003777171950787e-4, -8.642363827675581e-4, -0.0017318973550572991, 8.278516470454633e-4, 3.6373562761582434e-4, 0.003568309126421809, 0.0015010166680440307, 3.565545193850994e-5, 8.353755692951381e-4, 0.0013231289340183139, -0.00348366005346179, -0.002790294121950865, -0.001911200932227075, 0.0019140619551762938, 5.105992313474417e-4, -3.9057081448845565e-4, -8.990844944491982e-4, -1.1851674571516924e-5, 0.0010457341559231281, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[768][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53077>
        [
          [-0.0486324205994606, -0.013358641415834427, 0.011447390541434288, 0.06029258668422699, -0.012162522412836552, 0.03359825536608696, 0.004540959373116493, 0.022891473025083542, 0.07716593891382217, -0.03756820037961006, 0.011509292759001255, 0.017915818840265274, -0.0625162422657013, -0.02882455848157406, -0.05076751112937927, 0.03852172940969467, -0.012247278355062008, 0.03136202692985535, -0.037585992366075516, -0.03827454894781113, 0.035374805331230164, 0.013549121096730232, 0.02059405855834484, -0.005171214230358601, 0.026199156418442726, 0.004887640476226807, -0.03252137824892998, -0.05902782455086708, 0.06327345967292786, -0.02971808612346649, 0.03977939113974571, -0.04822481796145439, 0.0033213235437870026, 0.024874748662114143, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.0.attention.self.query" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.52998>
        [-0.6375944018363953, 0.47190165519714355, -0.19513511657714844, -0.11359386146068573, -0.11647912114858627, -0.18432101607322693, 0.18104968965053558, -0.02865990251302719, -0.18926051259040833, 0.13470743596553802, -0.424590528011322, -0.221030130982399, -0.4015921950340271, -0.10509775578975677, 0.34633201360702515, 0.1456173062324524, -0.23172250390052795, 0.020812030881643295, -0.17293894290924072, 0.23933455348014832, -0.2692466676235199, -0.215071901679039, 0.3713471293449402, -0.1444566398859024, 0.38154226541519165, 0.1379416137933731, -0.37020498514175415, 0.08660724014043808, 0.13922472298145294, 0.16149860620498657, 0.36550453305244446, -0.3040861487388611, -0.11859966814517975, -0.19751711189746857, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[768][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.52999>
        [
          [-0.03350241482257843, 0.024027612060308456, -0.0205643679946661, -0.005354847759008408, -0.0165963564068079, 0.04552008584141731, 0.03087504394352436, -0.015921741724014282, -0.006084536202251911, -0.021633196622133255, 0.08577318489551544, 0.03637205436825752, 0.030160026624798775, -0.01775282621383667, 0.04697144031524658, -0.02105986699461937, -0.012809906154870987, -0.04065600410103798, 0.10443095862865448, 0.028026947751641273, -0.009568239562213421, 0.015088281594216824, 0.033717039972543716, 0.005928704980760813, 0.035986386239528656, 0.02054641954600811, -0.04994944855570793, 0.004103112034499645, 0.033248066902160645, -0.0033450580667704344, 0.05453871563076973, -0.08188605308532715, -0.006623615976423025, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.9.output.dense" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53182>
        [0.05778000131249428, -0.09624391049146652, -0.0666242390871048, 0.11571042984724045, -0.04145992919802666, -0.08127769827842712, -0.021790307015180588, 0.048089541494846344, -0.003216393059119582, -0.03555576130747795, 0.014672313816845417, -0.009273212403059006, -0.0533149354159832, 0.07304508239030838, 0.028598826378583908, 0.049061574041843414, -0.08526615053415298, -0.07380382716655731, -0.028952939435839653, -0.010847309604287148, -0.0206162016838789, 0.060090355575084686, 0.046171460300683975, 0.03935794159770012, -0.08456715196371078, -0.07017671316862106, -0.001925126533024013, 0.14428649842739105, 0.1362699568271637, 0.03882477805018425, -0.03860543295741081, -3.8708571810275316e-4, -0.05729655548930168, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[3072][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53183>
        [
          [-0.038003165274858475, -0.007770792581140995, -0.00290418672375381, -0.014682987704873085, -0.028689401224255562, -0.006172545719891787, 0.025882797315716743, -0.009012067690491676, 0.00790103618055582, -0.005825130734592676, 0.04141869395971298, -0.009901861660182476, -0.00684581371024251, 0.009765500202775002, -0.010771128349006176, -0.01417272537946701, -0.02056870236992836, -0.02829081192612648, 0.037935107946395874, -0.07002004235982895, -0.006886417977511883, -0.03457149863243103, 0.004515760112553835, 0.02327902615070343, 0.012014366686344147, -0.020754428580403328, -0.027173122391104698, 0.017925942316651344, 0.0021912066731601954, -0.019312448799610138, -0.033442117273807526, -0.020454013720154762, ...],
          ...
        ]
      >
    },
    "bert.embeddings.LayerNorm" => %{
      "beta" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.52987>
        [-0.010793288238346577, -0.011809886433184147, -0.04613706097006798, -0.03723820671439171, 0.03405315428972244, -0.05620851740241051, 0.035412609577178955, -0.16566327214241028, -0.004289733711630106, -0.06275589019060135, 0.023426471278071404, -0.021457325667142868, -0.01629980094730854, -0.020297065377235413, -0.008755230344831944, -0.10770834982395172, -0.01038743369281292, -0.04541875049471855, -0.001075154636055231, 0.013488814234733582, -0.035421036183834076, 0.018808729946613312, -0.05856684222817421, -0.04733660817146301, -0.07909902930259705, 0.018554702401161194, -0.0678190290927887, -0.06600796431303024, 0.03959481045603752, 3.378022229298949e-4, -0.013474708423018456, 0.43636757135391235, ...]
      >,
      "gamma" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.52988>
        [0.9263466596603394, 0.9092982411384583, 0.9321309328079224, 0.9003349542617798, 0.8209360837936401, 0.9104894995689392, 0.6506876349449158, 0.668155312538147, 0.9414101839065552, 0.8507885336875916, 0.9142820835113525, 0.9097239971160889, 0.968343198299408, 0.9176481366157532, 0.9200752377510071, 0.5475963354110718, 0.931835412979126, 0.902339518070221, 0.8832138180732727, 0.9102476835250854, 0.807241678237915, 0.93853360414505, 0.9281906485557556, 0.9104084968566895, 0.8567752242088318, 0.8669373393058777, 0.9207462668418884, 0.9119066596031189, 0.898968517780304, 0.9280589818954468, 0.9221025705337524, ...]
      >
    },
    "bert.encoder.layer.2.output.dense" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53070>
        [-0.022964030504226685, -0.02450631372630596, 0.002677337732166052, -0.006657234858721495, -0.033247869461774826, 0.08851370215415955, 0.027509517967700958, 0.08388224989175797, 0.006161937490105629, -0.011917361989617348, 0.049554094672203064, 0.046236902475357056, -0.021025056019425392, -0.08263269811868668, -0.013477006927132607, 0.12072885781526566, 0.023879431188106537, 0.020961396396160126, 0.016802053898572922, -0.04534152150154114, 0.04921684041619301, 0.03847116231918335, -0.004111391492187977, 0.0023855329491198063, -0.11283430457115173, -0.03354595601558685, -0.02633327804505825, 0.02158574014902115, 0.03383069112896919, -0.0015007291221991181, 0.006621976848691702, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[3072][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53071>
        [
          [-0.018002735450863838, 0.016236692667007446, -0.01825805753469467, 0.02936054766178131, -0.016383502632379532, -0.002885635243728757, 0.031289003789424896, 0.015279865823686123, -0.015934783965349197, -0.018474243581295013, 0.02157985046505928, -0.00822796393185854, 0.0243803933262825, 0.005165840964764357, 0.016998838633298874, -0.017160343006253242, -3.3362137037329376e-4, 0.06163259968161583, 0.052288368344306946, -0.03875825181603432, 0.005144933238625526, -0.029189929366111755, -0.02458054944872856, 0.022524692118167877, 0.02282937988638878, 0.007634125649929047, 0.004177875351160765, 0.034869950264692307, -0.02836609072983265, -0.030315542593598366, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.7.attention.output.dense" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53138>
        [-0.03949953243136406, -0.0021069112699478865, 0.0687946081161499, 0.00153837981633842, 0.04275050014257431, 0.03373387083411217, 0.09405388683080673, 0.03750947117805481, 0.01657107286155224, -0.02142808400094509, 0.025701606646180153, 0.004093460738658905, 0.007241206709295511, 0.05719199404120445, -0.03537055850028992, 0.003405265510082245, 0.019507575780153275, 0.020270053297281265, 0.06727369874715805, -0.04966704547405243, 0.09154615551233292, -0.06474646925926208, 0.013211464509367943, -0.0017019580118358135, 0.03998268023133278, -0.08870648592710495, -0.04535452648997307, -0.08099501579999924, 0.04148896783590317, -0.024622399359941483, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[768][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53139>
        [
          [0.021882029250264168, -0.03694872185587883, 0.021121935918927193, 0.026986652985215187, -0.010863774456083775, 0.018699629232287407, 0.031496915966272354, -0.01969367451965809, 0.007444532588124275, -0.0577886588871479, -0.006198501214385033, -0.01465521939098835, 0.028939571231603622, -0.01888827234506607, -0.006289768032729626, -0.03712493181228638, 0.009243244305253029, -6.869189091958106e-4, 0.02296004258096218, 0.01270477008074522, -0.002153323031961918, -0.03414077311754227, 0.038587700575590134, 0.04149716719985008, 0.002977177267894149, -6.315544596873224e-4, 0.0057374960742890835, 0.01965714618563652, 0.035171639174222946, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.10.attention.self.query" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53030>
        [0.028036052361130714, -0.00836262572556734, -0.04682401195168495, -0.014362665824592113, 0.007389821112155914, -0.016016563400626183, -0.0403781495988369, -0.008013018406927586, -0.023720696568489075, 0.01848677545785904, 0.08266537636518478, 0.0012308453442528844, 0.008347063325345516, 0.016432270407676697, 0.04089115187525749, 0.0108324084430933, 0.021410997956991196, -0.042342521250247955, -0.03074370138347149, 0.008893744088709354, 0.007224942557513714, 0.022583995014429092, 0.01687021739780903, 0.03489183261990547, -0.02395571768283844, 0.008817889727652073, -0.012019505724310875, -0.009035252965986729, 0.005345488432794809, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[768][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53031>
        [
          [0.008194656111299992, 0.04191344603896141, 0.0048215556889772415, 0.04668007418513298, -0.04203563928604126, -0.09036841988563538, -0.028722796589136124, 0.0033515472896397114, -0.11270975321531296, 0.04660653695464134, 0.006406033877283335, -0.012814568355679512, 0.06462031602859497, -0.00924837589263916, 0.003752403426915407, -0.006458954885601997, -0.037019263952970505, -0.030006812885403633, -0.04557480663061142, 0.011533745564520359, 0.0342218354344368, 0.04345192760229111, 0.035980042070150375, -0.0017727188533172011, 0.007752729579806328, -0.06012818589806557, 0.020410532131791115, 0.036814115941524506, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.1.intermediate.dense" => %{
      "bias" => #Nx.Tensor<
        f32[3072]
        EXLA.Backend<host:0, 0.446408219.3910795284.53018>
        [-0.0681677982211113, -0.08971108496189117, -0.09344729036092758, -0.12725581228733063, -0.010743830353021622, -0.0636029839515686, -0.08351270109415054, -0.10214881598949432, -0.07870744913816452, -0.09898446500301361, -0.0698622316122055, -0.08481369912624359, -0.019060373306274414, -0.06035847216844559, -0.10562331229448318, -0.09140881896018982, -0.06932064890861511, -0.04329429939389229, -0.06641637533903122, -0.08526750653982162, -0.07285954803228378, -0.06387712061405182, -0.06916205585002899, -0.05905335023999214, -0.005364945624023676, -0.06840121001005173, -0.06860647350549698, -0.07884582132101059, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[768][3072]
        EXLA.Backend<host:0, 0.446408219.3910795284.53019>
        [
          [0.016126839444041252, 0.025217711925506592, 0.02539072558283806, -0.013259957544505596, -0.004164969548583031, 0.07840467244386673, -0.004895031917840242, -0.03353757783770561, -0.00979679636657238, 0.02202577516436577, -0.03155185282230377, -0.014990406110882759, 0.007972834631800652, -0.0018819371471181512, -0.009920613840222359, -0.061080168932676315, -0.07825031876564026, -0.03454598784446716, 0.019579773768782616, -0.0022431721445173025, 0.004287616815418005, 0.0266073290258646, -0.005945646204054356, -0.005704101640731096, -0.02407672442495823, -0.045460332185029984, -0.049262870103120804, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.8.attention.self.query" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53158>
        [-0.031170502305030823, 0.021490177139639854, 0.14086143672466278, -0.045457176864147186, -0.04245654493570328, -0.15571393072605133, -0.12662972509860992, -0.04363582283258438, 0.09144741296768188, 0.007732229772955179, 0.010549928992986679, 0.022967670112848282, -0.012850127182900906, -0.09757362306118011, -0.03360207751393318, 0.01259175781160593, 0.18709006905555725, 0.04658448323607445, 0.06788516789674759, 0.03018508478999138, 0.015168687328696251, 0.18820025026798248, -0.09631123393774033, 0.023579752072691917, -0.11509718000888824, -0.04632176458835602, -0.013989093713462353, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[768][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53159>
        [
          [-4.317933926358819e-4, -0.0766216367483139, -0.03031298704445362, 0.048265669494867325, -0.09480166435241699, 0.06607139855623245, -0.04154615476727486, -0.0035543700214475393, 0.06592106074094772, 0.03147772699594498, 0.11061929911375046, 0.026471860706806183, -0.0334211140871048, 0.02401343360543251, -0.024531394243240356, -0.041666194796562195, -0.07026329636573792, -9.122217306867242e-4, 0.003237023949623108, -0.08820648491382599, 0.0788479894399643, -1.3237704115454108e-4, -0.039726343005895615, 0.001246425206772983, -0.07674474269151688, -0.01755383424460888, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.4.attention.self.query" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53094>
        [-0.16141395270824432, -0.013094976544380188, 0.26537781953811646, 0.45624542236328125, -0.1603820025920868, 0.09733535349369049, -0.13799668848514557, -0.06818778067827225, 0.2472052425146103, 0.3050295412540436, 0.3518204689025879, 0.12015889585018158, 0.034716323018074036, 0.01846248097717762, 0.04388109967112541, -0.0359732061624527, 0.10829313844442368, -0.1389012187719345, -0.1320839375257492, 0.07522554695606232, -0.06827055662870407, 0.0028449774254113436, -0.031960707157850266, -0.11618505418300629, 0.1218767985701561, -0.1944427639245987, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[768][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53095>
        [
          [-0.036362987011671066, 0.03793160617351532, -0.021229587495326996, -0.001933305524289608, 0.024793613702058792, 0.01525136362761259, -0.025938093662261963, -0.03719406574964523, -0.03591643646359444, -0.019651757553219795, -0.01259913295507431, -0.07709983736276627, 0.010727819055318832, 0.03373584896326065, 0.020797520875930786, 0.04914665222167969, -0.11047656834125519, -0.09652756154537201, 0.024299008771777153, -0.022699275985360146, -0.006873197853565216, 0.05704355984926224, 0.004285372793674469, -0.03385820984840393, -0.047410089522600174, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.10.output.LayerNorm" => %{
      "beta" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53036>
        [-0.08410080522298813, 0.022179335355758667, -0.035858843475580215, -0.04389021918177605, 4.404393839649856e-4, -0.025774462148547173, -0.011651609092950821, -0.041402336210012436, -0.03543641418218613, 0.01127591636031866, -0.036766692996025085, -0.06917133927345276, 0.0035299009177833796, -0.052056655287742615, -0.033892661333084106, -0.017425701022148132, -0.028629690408706665, -0.034850552678108215, 0.00572190759703517, 0.0073472908698022366, -0.03899921849370003, -0.024593058973550797, -0.03029654547572136, -0.02376827970147133, -0.04999864846467972, ...]
      >,
      "gamma" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53037>
        [0.9107499122619629, 0.9170510768890381, 0.9445287585258484, 0.9134490489959717, 0.9192716479301453, 0.9020618200302124, 0.8744416236877441, 0.928413450717926, 0.944787859916687, 0.8833742737770081, 0.9475340247154236, 0.960430920124054, 0.9503349661827087, 0.9599919319152832, 0.9602850079536438, 0.8973596096038818, 0.9305921196937561, 0.9113565683364868, 0.9309290051460266, 0.9312233924865723, 0.9434103965759277, 0.9428883790969849, 0.9339224696159363, 0.9416617155075073, ...]
      >
    },
    "bert.encoder.layer.2.attention.self.query" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53062>
        [5.957077955827117e-4, 0.024013729766011238, 0.005762150511145592, 0.005994389299303293, -0.0011557021643966436, -0.014633586630225182, 0.013196517713367939, -0.019915588200092316, 0.00224445853382349, -0.0550929419696331, -0.013592016883194447, 9.764724527485669e-4, 0.015287309885025024, -0.03975682705640793, -0.044432926923036575, 0.01178459357470274, -0.016014225780963898, -0.01571519486606121, -0.006902207154780626, 0.004275894723832607, 0.07982122153043747, 0.008011463098227978, -0.024160146713256836, 0.02356494404375553, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[768][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53063>
        [
          [-0.017424333840608597, 0.011008614674210548, 0.03323943912982941, -0.005494316108524799, 0.025520043447613716, -0.037040527909994125, -0.00474172830581665, 0.026389945298433304, -0.009156342595815659, 0.008813179098069668, 0.0017881740350276232, 0.05500021576881409, 0.0271520484238863, 0.02029382809996605, -0.0476166270673275, -0.006933038588613272, 0.05675875395536423, -0.0239802747964859, -0.027676774188876152, 0.023493189364671707, 0.03621729835867882, 0.013653581961989403, -0.05814552679657936, ...],
          ...
        ]
      >
    },
    "bert.embeddings.word_embeddings" => %{
      "kernel" => #Nx.Tensor<
        f32[28996][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.52991>
        [
          [-5.478383391164243e-4, -0.041568856686353683, 0.013083661906421185, 0.005755499936640263, -0.037633221596479416, 0.013274767436087132, 0.08125533163547516, 0.05623384192585945, -0.017871497198939323, 0.020253799855709076, -0.0322672575712204, -0.039308100938797, -0.024024227634072304, 0.008347730152308941, -0.016084467992186546, 0.0955670028924942, -0.014709480106830597, -0.04485480859875679, -0.03949921205639839, -0.03551776707172394, -0.08413833379745483, -0.03968473896384239, 0.02032049000263214, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.3.attention.output.LayerNorm" => %{
      "beta" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53072>
        [0.055234864354133606, 0.017888272181153297, -0.12400225549936295, -0.02547440119087696, -0.0914531871676445, 0.14831416308879852, -0.12317754328250885, 0.28457480669021606, 0.14697441458702087, -0.020028570666909218, 0.11323453485965729, 0.003001939272508025, -0.01431051455438137, -0.12584209442138672, 0.0028758125845342875, 0.22376365959644318, -0.03420255705714226, -0.02571358159184456, -0.05154882371425629, -0.07426103204488754, 0.03692513704299927, 0.08104931563138962, ...]
      >,
      "gamma" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53073>
        [0.9452854990959167, 0.9235751628875732, 0.941977858543396, 0.9194402098655701, 0.8896099328994751, 0.9197066426277161, 0.8817213177680969, 0.9433790445327759, 0.9604038596153259, 0.9039281606674194, 0.959800660610199, 0.9456019401550293, 0.9555606842041016, 0.94105464220047, 0.9372249245643616, 0.8635942339897156, 0.9062595963478088, 0.9102791547775269, 0.9095903038978577, 0.9528236389160156, 0.9287355542182922, ...]
      >
    },
    "bert.encoder.layer.0.output.LayerNorm" => %{
      "beta" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53004>
        [0.03038134053349495, -0.11564555019140244, -0.03589656949043274, -0.03288423642516136, 0.0022226274013519287, -0.04334518685936928, 0.16845916211605072, -0.0757162943482399, -0.04984371364116669, -0.05838024243712425, -0.0040581487119197845, -0.10355298966169357, -0.05565619841217995, -0.07313288748264313, -0.049528516829013824, -0.11445362120866776, -0.0066063497215509415, -0.052704159170389175, -0.05210529640316963, -0.03804129362106323, -0.15227322280406952, ...]
      >,
      "gamma" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53005>
        [0.903571367263794, 0.9003798365592957, 0.909981369972229, 0.9011331796646118, 0.8734743595123291, 0.9086540341377258, 0.7816029787063599, 0.7875540852546692, 0.9262253046035767, 0.8588747978210449, 0.9283396005630493, 0.9033386707305908, 0.9458111524581909, 0.9203267693519592, 0.9291556477546692, 0.7518654465675354, 0.9202855229377747, 0.9032572507858276, 0.894541323184967, 0.9144267439842224, ...]
      >
    },
    "bert.encoder.layer.8.attention.self.value" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53160>
        [-0.015987582504749298, -6.876057595945895e-4, -0.013237002305686474, -0.009969061240553856, 0.06931136548519135, -0.022168830037117004, -0.06265285611152649, 0.030408313497900963, 0.02063106931746006, -0.009429039433598518, -0.01064386311918497, 0.01738535799086094, -0.045285191386938095, 0.018217116594314575, 0.016792217269539833, -0.06399557739496231, -9.247878333553672e-4, 0.024427399039268494, 0.05703256279230118, -0.003718979423865676, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[768][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53161>
        [
          [-0.04831257089972496, 0.02048526145517826, -0.0362376794219017, 0.03918555751442909, -0.011986122466623783, 0.07344716042280197, 0.043200451880693436, -0.007625164929777384, 0.021726975217461586, -0.01635059341788292, -0.054123133420944214, -0.049902040511369705, -0.050450824201107025, -0.054629791527986526, 0.004039873834699392, -0.015709223225712776, 0.05366622656583786, 0.03617807850241661, -0.009382096119225025, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.1.attention.self.value" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53016>
        [-8.343663066625595e-4, -0.004619269166141748, -0.010048001073300838, 0.009855296462774277, -0.017395809292793274, 8.38714768178761e-4, 0.006549294572323561, 0.007236767560243607, -0.004516380839049816, -0.011764063499867916, 0.008927441202104092, -0.019828353077173233, 0.026078321039676666, 0.02112170308828354, 7.352182292379439e-4, -0.003470609663054347, -0.010961364954710007, -0.0018152105621993542, -0.003428294323384762, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[768][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53017>
        [
          [0.019315633922815323, 0.041598234325647354, -0.01662556827068329, 0.003513836534693837, 0.012050913646817207, -0.04108555614948273, -0.01925881765782833, -0.03989705070853233, -0.051690176129341125, -0.010674461722373962, -0.0308759193867445, -0.001015945104882121, -0.029720688238739967, -5.357129848562181e-4, -0.0023665684275329113, 0.016924235969781876, 0.0026176413521170616, -0.010141264647245407, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.9.attention.output.LayerNorm" => %{
      "beta" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53168>
        [0.04221687093377113, -0.12525862455368042, -0.08424632251262665, 0.14216263592243195, -0.03601190447807312, -0.03694118931889534, -0.08714569360017776, 0.061541199684143066, 0.010608160868287086, -0.05316801741719246, 0.009398656897246838, 0.004663764964789152, -0.051269616931676865, 0.011335482820868492, 0.05396180972456932, 0.08670956641435623, -0.0710258036851883, -0.11588223278522491, ...]
      >,
      "gamma" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53169>
        [0.9208793044090271, 0.9122349619865417, 0.9074700474739075, 0.9077407121658325, 0.899644672870636, 0.8632360100746155, 0.8721860647201538, 0.8672940135002136, 0.9016156196594238, 0.8811227083206177, 0.9071623086929321, 0.9142878651618958, 0.9285129308700562, 0.909907877445221, 0.9001787900924683, 0.8363674879074097, 0.8775027394294739, ...]
      >
    },
    "bert.encoder.layer.10.output.dense" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53038>
        [0.07874300330877304, -0.09511342644691467, -0.06061379611492157, 0.13647803664207458, -0.05515165254473686, -0.08379770070314407, -0.11703289300203323, 0.06486106663942337, 0.059791773557662964, -0.07831569015979767, 0.023110829293727875, -0.029457321390509605, -0.0443791002035141, 0.042671628296375275, 0.002516829874366522, 0.07744931429624557, -0.0206303671002388, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[3072][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53039>
        [
          [-0.0046742139384150505, 0.017753934487700462, -0.018830405548214912, -0.04249034449458122, 0.04737995192408562, 0.014424179680645466, -0.018234537914395332, 0.006878320127725601, 0.04138905555009842, -0.007070711348205805, 0.03840873762965202, 0.01261711772531271, 0.014976727776229382, -0.029048405587673187, 0.007968686521053314, -0.014605462551116943, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.0.output.dense" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53006>
        [0.015596365556120872, 0.03703022375702858, -0.016733137890696526, 0.07404071092605591, 0.01574079692363739, 0.10284546762704849, 0.043021369725465775, 0.06522896885871887, -0.013106508180499077, -0.04100704938173294, 0.09611722081899643, 0.029821837320923805, 0.0196005180478096, -0.07071729004383087, 0.006921960506588221, 0.16820283234119415, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[3072][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53007>
        [
          [0.008109993301331997, -0.01684303767979145, -0.005793801508843899, 0.03503894433379173, 0.07166536152362823, 0.02934904396533966, -0.031742922961711884, -0.02560320869088173, -0.020349005237221718, 0.07658377289772034, 0.003619435243308544, -0.0644126832485199, -0.06840699911117554, -0.011856959201395512, -0.041856713593006134, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.3.attention.output.dense" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53074>
        [0.02145242877304554, 0.04115705564618111, -0.034305550158023834, 0.026804454624652863, 0.03926630690693855, 0.11583568900823593, 0.07245716452598572, -0.06816226989030838, -0.015520209446549416, -0.05344724282622337, 0.013624761253595352, 0.047487758100032806, 0.026202479377388954, 0.04609924927353859, -0.01411708164960146, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[768][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53075>
        [
          [-4.1111462633125484e-4, 0.005745967384427786, -0.04271765053272247, -0.014939315617084503, -0.03755500167608261, 8.677973528392613e-4, -0.022967858240008354, -0.005141725298017263, 0.03663254156708717, -0.03700242564082146, 0.0027544056065380573, -0.021708227694034576, 0.020394042134284973, 0.014599769376218319, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.11.output.LayerNorm" => %{
      "beta" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53052>
        [0.02125834859907627, -0.021490907296538353, -0.002114717848598957, -0.029723595827817917, -0.028710976243019104, 0.02574586123228073, -0.010717042721807957, -0.08282411843538284, 0.032012343406677246, -0.06921486556529999, -0.027408186346292496, 0.004533589817583561, -0.07493114471435547, -0.0015531448880210519, ...]
      >,
      "gamma" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53053>
        [0.7315859794616699, 0.7459272146224976, 0.7427966594696045, 0.7240387797355652, 0.7438919544219971, 0.7456466555595398, 0.7604195475578308, 0.7346193194389343, 0.7816157341003418, 0.7070452570915222, 0.7477391362190247, 0.7477520108222961, 0.805452287197113, ...]
      >
    },
    "bert.encoder.layer.4.output.dense" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53102>
        [-0.009590689092874527, -0.015414339490234852, -0.04348713532090187, 0.0031679661478847265, -0.04074957221746445, 0.05835094302892685, -0.02439994178712368, 0.06980925053358078, 0.0026213882956653833, -0.04280189797282219, 0.05842527747154236, 0.014367889612913132, -0.04395109415054321, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[3072][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53103>
        [
          [-0.05548404902219772, -0.02313743531703949, -0.023863408714532852, 0.007337337359786034, 0.08429411053657532, 0.03571293503046036, 0.030876556411385536, -0.0014196671545505524, -0.03820905089378357, -0.024250119924545288, -0.03191112354397774, 0.020862577483057976, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.0.attention.self.key" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.52996>
        [-4.507539269980043e-4, 6.393066141754389e-4, -1.3673312787432224e-4, -4.4833231368102133e-4, -4.829686658922583e-4, 8.533523068763316e-4, -6.247100536711514e-4, 7.720892899669707e-4, -4.6401782310567796e-4, 4.8441291437484324e-4, 9.706049604574218e-5, -7.474374724552035e-4, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[768][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.52997>
        [
          [0.028657175600528717, 0.004800526425242424, 0.04907591640949249, -0.039223309606313705, 0.0021487665362656116, -0.001438757637515664, 0.003718537976965308, -0.04054681956768036, -0.009422333911061287, -0.016424333676695824, -0.0713995099067688, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.9.output.LayerNorm" => %{
      "beta" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53180>
        [-0.08386478573083878, 0.04830888658761978, -0.02703983709216118, -0.06663387268781662, 0.002252766164019704, -0.10078848898410797, 0.024267295375466347, -0.06310189515352249, -0.04794350266456604, 0.04224136471748352, -0.08554761111736298, ...]
      >,
      "gamma" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53181>
        [0.9063484072685242, 0.926838755607605, 0.929550290107727, 0.9152014851570129, 0.9429000616073608, 0.9363250136375427, 0.8914496898651123, 0.9276359677314758, 0.922518789768219, 0.9044700860977173, ...]
      >
    },
    "bert.encoder.layer.2.attention.output.dense" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53058>
        [-0.04780908301472664, 0.008637601509690285, -0.06531859934329987, 0.033869560807943344, 0.22702603042125702, -0.002832130528986454, -0.07599403709173203, -0.06081544607877731, 0.0014925115974619985, -0.04231279715895653, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[768][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53059>
        [
          [0.030927961692214012, -0.005970419850200415, -0.009860245510935783, -0.039186570793390274, 8.025218266993761e-5, -0.004696608521044254, -0.018968604505062103, -0.021016480401158333, -0.033588722348213196, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.5.attention.self.value" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53112>
        [0.020336588844656944, -0.001424792455509305, 0.001783320214599371, 0.0035121547989547253, 0.020622070878744125, 0.003753982950001955, 0.00655283173546195, -0.008446347899734974, -0.00484004570171237, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[768][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53113>
        [
          [-0.032322268933057785, 0.02511126548051834, -0.0013141768286004663, -0.010092467069625854, 0.009296819567680359, -0.009304020553827286, -0.007763926405459642, 0.00165150361135602, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.8.attention.output.dense" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53154>
        [-0.04109989106655121, 0.03976622596383095, 0.11077992618083954, 0.024203097447752953, 0.039913609623909, 0.011197798885405064, 0.08930294215679169, -0.008949615061283112, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[768][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53155>
        [
          [-0.012043245136737823, 0.005921437870711088, -0.020956985652446747, -0.03985541686415672, 0.03660556301474571, 0.046383086591959, 0.0035501897800713778, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.4.attention.self.value" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53096>
        [-0.010564289055764675, -0.01785954087972641, 0.004131804220378399, -0.0015158986207097769, 0.012544877827167511, 0.02462768740952015, -0.05158676952123642, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[768][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53097>
        [
          [0.01706995628774166, 0.03468291461467743, -0.010742810554802418, 0.037910934537649155, -0.04912202060222626, 0.026370162144303322, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.11.attention.output.LayerNorm" => %{
      "beta" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53040>
        [0.06394603848457336, -0.05454377084970474, 0.03622017055749893, 0.005405740812420845, -0.12871763110160828, 0.014321461319923401, ...]
      >,
      "gamma" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53041>
        [0.9301626682281494, 0.8859462738037109, 0.8787089586257935, 0.9291783571243286, 0.9035063982009888, ...]
      >
    },
    "bert.encoder.layer.10.attention.output.dense" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53026>
        [-0.05950526148080826, 0.03140132874250412, 0.07149486243724823, -0.0040215421468019485, 0.02815178409218788, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[768][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53027>
        [
          [0.06947967410087585, -0.005280793644487858, -0.0075445459224283695, -0.004148615058511496, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.10.attention.output.LayerNorm" => %{
      "beta" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53024>
        [0.04211768880486488, -0.1924131065607071, 0.010986041277647018, 0.11253747344017029, ...]
      >,
      "gamma" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53025>
        [0.9149337410926819, 0.9137728810310364, 0.890708327293396, ...]
      >
    },
    "bert.encoder.layer.6.output.LayerNorm" => %{
      "beta" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53132>
        [-0.012771210633218288, 0.026970677077770233, 0.05235074460506439, ...]
      >,
      "gamma" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53133>
        [0.9506392478942871, 0.9620101451873779, ...]
      >
    },
    "bert.encoder.layer.1.attention.self.key" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53012>
        [-7.524822722189128e-4, -0.0014464431442320347, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[768][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53013>
        [
          [-0.010469809174537659, ...],
          ...
        ]
      >
    },
    "bert.encoder.layer.6.output.dense" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53134>
        [0.019633563235402107, ...]
      >,
      "kernel" => #Nx.Tensor<
        f32[3072][768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53135>
        [
          ...
        ]
      >
    },
    "bert.encoder.layer.4.attention.output.dense" => %{
      "bias" => #Nx.Tensor<
        f32[768]
        EXLA.Backend<host:0, 0.446408219.3910795284.53090>
        [...]
      >,
      ...
    },
    "bert.encoder.layer.5.output.LayerNorm" => %{...},
    ...
  },
  spec: %Bumblebee.Text.Bert{
    architecture: :for_sequence_classification,
    vocab_size: 28996,
    max_positions: 512,
    max_token_types: 2,
    hidden_size: 768,
    num_blocks: 12,
    num_attention_heads: 12,
    intermediate_size: 3072,
    activation: :gelu,
    dropout_rate: 0.1,
    attention_dropout_rate: 0.1,
    classifier_dropout_rate: nil,
    layer_norm_epsilon: 1.0e-12,
    initializer_scale: 0.02,
    output_hidden_states: false,
    output_attentions: false,
    num_labels: 5,
    id_to_label: %{},
    use_cross_attention: false,
    pad_token_id: 0,
    forced_eos_token_id: nil,
    forced_bos_token_id: nil
  }
}
```

The Axon model actually outputs a map with `:logits`, `:hidden_states`, and `:attentions`. You can see this by using `Axon.get_output_shape/2` with an input. This method symbolically executes the graph and gets the resulting shapes:

```elixir
[{input, _}] = Enum.take(train_data, 1)
Axon.get_output_shape(model, input)
```

<!-- livebook:{"output":true} -->

```
%{attentions: #Axon.None<...>, hidden_states: #Axon.None<...>, logits: {32, 5}}
```

For training, we only care about the `:logits` key, so we'll extract that by attaching an `Axon.nx/2` layer to the model:

```elixir
logits_model = Axon.nx(model, & &1.logits)
```

<!-- livebook:{"output":true} -->

```
#Axon<
  inputs: %{"attention_head_mask" => {12, 12}, "attention_mask" => {nil, nil}, "input_ids" => {nil, nil}, "position_ids" => {nil, nil}, "token_type_ids" => {nil, nil}}
  outputs: "nx_0"
  nodes: 699
>
```

Now we can declare our training loop. You can construct Axon training loops using the `Axon.Loop.trainer/4` factory method with a model, loss function, and optimizer. We'll also adjust the log-settings to more frequently log metrics to standard out. The `:identity` parameter in `Axon.Loop.trainer/4` tells Axon we are not using loss-scaling in this training loop:

```elixir
loss =
  &Axon.Losses.categorical_cross_entropy(&1, &2,
    reduction: :mean,
    from_logits: true,
    sparse: true
  )

optimizer = Axon.Optimizers.adam(5.0e-5)

loop = Axon.Loop.trainer(logits_model, loss, optimizer, :identity, log: 1)
```

<!-- livebook:{"output":true} -->

```
#Axon.Loop<
  metrics: %{
    "loss" => {#Function<10.57244955/3 in Axon.Metrics.running_average/1>,
     #Function<41.3316493/2 in :erl_eval.expr/6>}
  },
  handlers: %{
    completed: [],
    epoch_completed: [
      {#Function<24.11164779/1 in Axon.Loop.log/3>,
       #Function<6.11164779/1 in Axon.Loop.build_filter_fn/1>}
    ],
    epoch_halted: [],
    epoch_started: [],
    halted: [],
    iteration_completed: [
      {#Function<24.11164779/1 in Axon.Loop.log/3>,
       #Function<4.11164779/1 in Axon.Loop.build_filter_fn/1>}
    ],
    iteration_started: [],
    started: []
  },
  ...
>
```

The call to trainer just returns a data structure. In Axon, we manipulate this data structure to control different parts of the loop. For example, you can attach metrics:

```elixir
accuracy = &Axon.Metrics.accuracy(&1, &2, from_logits: true, sparse: true)

loop = Axon.Loop.metric(loop, accuracy, "accuracy")
```

<!-- livebook:{"output":true} -->

```
#Axon.Loop<
  metrics: %{
    "accuracy" => {#Function<10.57244955/3 in Axon.Metrics.running_average/1>,
     #Function<41.3316493/2 in :erl_eval.expr/6>},
    "loss" => {#Function<10.57244955/3 in Axon.Metrics.running_average/1>,
     #Function<41.3316493/2 in :erl_eval.expr/6>}
  },
  handlers: %{
    completed: [],
    epoch_completed: [
      {#Function<24.11164779/1 in Axon.Loop.log/3>,
       #Function<6.11164779/1 in Axon.Loop.build_filter_fn/1>}
    ],
    epoch_halted: [],
    epoch_started: [],
    halted: [],
    iteration_completed: [
      {#Function<24.11164779/1 in Axon.Loop.log/3>,
       #Function<4.11164779/1 in Axon.Loop.build_filter_fn/1>}
    ],
    iteration_started: [],
    started: []
  },
  ...
>
```

And you can attach event handlers to do certain things, such as serialize the loop state at regular intervals so you don't lose your progress:

```elixir
loop = Axon.Loop.checkpoint(loop, event: :epoch_completed)
```

<!-- livebook:{"output":true} -->

```
#Axon.Loop<
  metrics: %{
    "accuracy" => {#Function<10.57244955/3 in Axon.Metrics.running_average/1>,
     #Function<41.3316493/2 in :erl_eval.expr/6>},
    "loss" => {#Function<10.57244955/3 in Axon.Metrics.running_average/1>,
     #Function<41.3316493/2 in :erl_eval.expr/6>}
  },
  handlers: %{
    completed: [],
    epoch_completed: [
      {#Function<15.11164779/1 in Axon.Loop.checkpoint/2>,
       #Function<6.11164779/1 in Axon.Loop.build_filter_fn/1>},
      {#Function<24.11164779/1 in Axon.Loop.log/3>,
       #Function<6.11164779/1 in Axon.Loop.build_filter_fn/1>}
    ],
    epoch_halted: [],
    epoch_started: [],
    halted: [],
    iteration_completed: [
      {#Function<24.11164779/1 in Axon.Loop.log/3>,
       #Function<4.11164779/1 in Axon.Loop.build_filter_fn/1>}
    ],
    iteration_started: [],
    started: []
  },
  ...
>
```

To run the loop, you just need to call `Axon.Loop.run/4`. `Axon.Loop.run/4` takes a loop, input data, and any initial state (in this case initial parameters). You can kind of think of `Axon.Loop.run/4` as an `Enum.reduce/3`. It takes data, an accumulator, and a function---which map to `Loop.run/4` input data, initial state, and the actual loop data structure.

You'll commonly see loops written out in long chains using Elixir's `|>` operator, like this:

```elixir
trained_model_state =
  logits_model
  |> Axon.Loop.trainer(loss, optimizer, :identity, log: 1)
  |> Axon.Loop.metric(accuracy, "accuracy")
  |> Axon.Loop.checkpoint(event: :epoch_completed)
  |> Axon.Loop.run(train_data, params, epochs: 3)
```

<!-- livebook:{"output":true} -->

```
Epoch: 0, Batch: 249, accuracy: 0.3605000 loss: 1.1831361
Epoch: 1, Batch: 249, accuracy: 0.5363751 loss: 1.0118284
Epoch: 2, Batch: 249, accuracy: 0.6470000 loss: 0.8826395
```

<!-- livebook:{"output":true} -->

```
%{
  "bert.encoder.layer.1.attention.output.dense" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158456>
      [-0.06520550698041916, -0.008723030798137188, -0.08494863659143448, -0.02001851238310337, 0.04542425647377968, -0.06499189138412476, 0.08106913417577744, -0.1695755422115326, -0.02655990608036518, 0.052924398332834244, 0.07968413829803467, 0.06234009191393852, 0.0024211856070905924, 0.031540632247924805, -0.042218971997499466, 0.004623208660632372, 0.09107270836830139, -0.07219309359788895, 0.11843057721853256, -0.026387305930256844, 0.014727726578712463, 0.02046859823167324, -0.037562739104032516, 0.02919340692460537, -0.16505014896392822, -0.09426430612802505, -0.03929213061928749, -0.14652471244335175, 0.006117356941103935, 0.0653621181845665, 0.026919769123196602, 0.029354531317949295, -0.0018898277776315808, -0.06240864470601082, 0.011992981657385826, -0.03222104534506798, -0.16964569687843323, 0.028845060616731644, -0.22748415172100067, -0.11564001441001892, -0.03644254803657532, 0.09405270218849182, 0.024852054193615913, 0.0065349009819328785, 0.02573656477034092, 0.009735509753227234, -0.017842179164290428, -0.0016559363575652242, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[768][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158457>
      [
        [0.04417994245886803, -0.016148773953318596, 0.021745756268501282, 0.0037950517144054174, 0.04845914989709854, 0.0013220608234405518, -0.04647081345319748, 0.039995964616537094, 0.005936742760241032, 0.044469427317380905, 0.0012630680575966835, 0.022433770820498466, -0.0016053550643846393, 0.03609499707818031, -0.02857831120491028, -0.06501372158527374, -0.030181443318724632, 0.01975136250257492, 0.014997752383351326, 0.0320439450442791, 0.016346188262104988, -0.02590298280119896, 0.03960537910461426, -0.02961440570652485, -0.031299758702516556, 0.03653455153107643, -0.005531935021281242, 0.0025067843962460756, -0.012348138727247715, 0.005098083987832069, 0.013740298338234425, 0.023625507950782776, -0.010130351409316063, 0.023403335362672806, -0.022756652906537056, -0.02013741433620453, -0.02967263199388981, -0.05481788516044617, -0.04752098768949509, 0.0015879352577030659, 0.02340567857027054, -0.047844886779785156, 0.004247112199664116, 3.3419474493712187e-4, -0.031192172318696976, -0.041654814034700394, -0.0032483621034771204, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.8.output.LayerNorm" => %{
    "beta" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158610>
      [-0.06606478244066238, 0.04627017676830292, -0.005884860642254353, -0.12128645181655884, 0.02158362790942192, -0.07094977051019669, 0.05417406186461449, -0.09344606846570969, -0.05942825973033905, 0.02905016764998436, -0.09624467045068741, -0.022176280617713928, -0.012312767095863819, 0.05677817761898041, -0.055324845016002655, -0.05998251587152481, -0.03298225253820419, -0.008456019684672356, -0.014447477646172047, 0.03137751668691635, -0.05630733072757721, -0.04537642374634743, -0.05085749924182892, -0.0646684467792511, -0.025162119418382645, -0.031092965975403786, -0.09139765053987503, -0.1904027909040451, -0.032849740236997604, -0.0658227726817131, -0.0526764877140522, 0.031474363058805466, 0.04721325263381004, -0.008168770000338554, -0.14523707330226898, -0.05686741694808006, 0.03949663043022156, -0.03456193581223488, -0.05926716327667236, -0.14907927811145782, -0.004578061401844025, 0.03222659230232239, -0.07389333844184875, -0.04387334734201431, -0.0029311298858374357, -5.743528017774224e-4, -0.03577922284603119, ...]
    >,
    "gamma" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158611>
      [0.9120063781738281, 0.9346441030502319, 0.9283782839775085, 0.9077304601669312, 0.9443027973175049, 0.9346618056297302, 0.87939453125, 0.9206302165985107, 0.9342255592346191, 0.9309639930725098, 0.9384106993675232, 0.9406033754348755, 0.9440609216690063, 0.9569255709648132, 0.9424173831939697, 0.9220483303070068, 0.9340174198150635, 0.9405742287635803, 0.9363421201705933, 0.9418064951896667, 0.9303426146507263, 0.9400733113288879, 0.9196386337280273, 0.9310140609741211, 0.9542289972305298, 0.9215259552001953, 0.9383236765861511, 0.8700889945030212, 0.9417020678520203, 0.9338635206222534, 0.9447970390319824, 0.9169049263000488, 0.9273132085800171, 0.9126197099685669, 0.9219021797180176, 0.9359512329101562, 0.9217914342880249, 0.9381892085075378, 0.9244728088378906, 0.8805890679359436, 0.928881824016571, 0.9471823573112488, 0.8947051167488098, 0.948526918888092, 0.9569637775421143, 0.9354196190834045, ...]
    >
  },
  "bert.encoder.layer.7.output.dense" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158596>
      [0.11509444564580917, -0.07701286673545837, -0.10494989901781082, 0.1524972915649414, -0.016467124223709106, -0.036900922656059265, 0.03170502185821533, 0.07008302956819534, -0.0020510966423898935, -0.05815684422850609, 0.037140220403671265, -0.05021520331501961, -0.03689301386475563, -0.06448700278997421, 0.09728236496448517, 0.06953442096710205, -0.059483643621206284, -0.07057695090770721, -0.0495135560631752, -0.15563957393169403, 0.057272158563137054, 0.030997812747955322, -0.009803569875657558, -0.026879476383328438, -0.097724050283432, -0.07578673958778381, 0.03388381749391556, 0.08767680823802948, 0.00473755644634366, 0.11011853814125061, 0.030364613980054855, -0.11033570766448975, 0.03889011964201927, -0.20575031638145447, 0.10664089769124985, 0.016993975266814232, -0.06915513426065445, 0.010772849433124065, 0.10416288673877716, 0.14049561321735382, -0.0029734717682003975, -0.011951222084462643, -0.023825496435165405, -0.07294221967458725, 0.009232329204678535, 0.0028589542489498854, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[3072][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158597>
      [
        [0.08129125088453293, -0.012010057456791401, -0.07070000469684601, -0.072170190513134, -0.0332794263958931, 0.04503543674945831, 0.020776759833097458, -0.013540973886847496, 0.05313296243548393, 0.03942522406578064, 0.023955121636390686, 0.04969659075140953, -0.016401682049036026, 0.06411036849021912, 0.021905751898884773, 0.08691570907831192, -0.05381361395120621, 0.02054094709455967, -0.02559167705476284, -0.030850861221551895, -0.05009302496910095, 0.035798024386167526, 0.055118128657341, 0.07631096988916397, 0.05693531781435013, -0.06186533346772194, -0.044887520372867584, 0.03599053993821144, -1.6941696230787784e-4, -0.028993772342801094, 0.0024462894070893526, 0.03470398485660553, -0.030759286135435104, -0.001198766753077507, -0.029168751090765, -0.005564594641327858, -0.011323404498398304, -0.02346581034362316, -0.057636916637420654, 0.10690605640411377, -0.02402559295296669, 0.03173067793250084, -0.04948088899254799, -0.011419476941227913, -0.0418965220451355, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.11.attention.output.dense" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158488>
      [-0.09562968462705612, 0.011231042444705963, 0.027160050347447395, -0.01667950302362442, 0.0724257379770279, 0.011822567321360111, 0.024451840668916702, -0.0014175176620483398, -0.09369012713432312, 0.0593959204852581, 0.027386954054236412, 0.05595528334379196, 0.08986654132604599, 0.06136128306388855, 0.06496763229370117, -0.03752792626619339, -0.014958355575799942, -0.010647430084645748, -0.04799112305045128, 0.07662340253591537, 0.05944322794675827, 0.035912927240133286, -0.05698605626821518, -0.05154798552393913, 0.05463504046201706, -0.018459435552358627, -0.03965768963098526, -0.012399008497595787, 0.09828714281320572, 0.005053588654845953, 0.00398657750338316, -0.09221401065587997, 0.08500084280967712, 0.025063853710889816, 0.017318537458777428, -0.0728493481874466, 0.0056876568123698235, 0.05471300333738327, 0.01633928343653679, -0.01702491007745266, 0.048051927238702774, -0.04756215959787369, -0.06660139560699463, -0.007383400108665228, -0.06689170747995377, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[768][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158489>
      [
        [-0.05671979859471321, -0.010363743640482426, -0.019709065556526184, 0.02218104898929596, 0.020722614601254463, -0.03335098549723625, 0.008569752797484398, 0.05533226206898689, -0.030393874272704124, 0.023050280287861824, 0.017441457137465477, 0.04757729545235634, -0.04677252843976021, -0.0032800433691591024, -0.0054547167383134365, 0.035303570330142975, -0.050305601209402084, -0.017668187618255615, -0.03768790885806084, 0.06996474415063858, 0.0022827403154224157, 0.04070596396923065, -0.05039500445127487, 0.022170977666974068, -0.04157959669828415, -0.010318856686353683, 0.06020781770348549, 0.0011198046850040555, -0.0339275598526001, -0.05599979683756828, 0.02672847919166088, -0.02748759649693966, 0.03773657977581024, 0.06628432869911194, -0.015480650588870049, -0.003089551581069827, 0.02259671874344349, 0.0473940446972847, 0.03725345432758331, -0.040479157119989395, 0.014734651893377304, -0.05081365257501602, -0.043379202485084534, -0.03723045811057091, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.9.attention.self.query" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158620>
      [0.08923040330410004, 0.018796462565660477, 0.07486888766288757, -0.026080699637532234, 0.0024441941641271114, -0.29199841618537903, -0.26539573073387146, -0.06681186705827713, -0.18633250892162323, -0.011429745703935623, 0.29377466440200806, 0.13714686036109924, 0.051851313561201096, -0.07187797129154205, 0.21130238473415375, -0.05453997850418091, 0.03094746731221676, 0.036153849214315414, -0.3248761296272278, -0.08307840675115585, 0.06858992576599121, -0.11173703521490097, -0.1278943419456482, -0.01642150990664959, -0.009606152772903442, 0.04124376177787781, 0.09752891957759857, 0.08019008487462997, -0.004071605391800404, -0.1548963040113449, 0.03163490071892738, -0.05431286618113518, -0.0494808666408062, -0.03512788936495781, 0.10907154530286789, 0.12277156859636307, -0.08885419368743896, 0.30419161915779114, -0.05166209116578102, 0.11559177935123444, -0.12209243327379227, -0.09057753533124924, -0.16645705699920654, -0.16450461745262146, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[768][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158621>
      [
        [-0.012961315922439098, -0.02712266333401203, 0.011162564158439636, 0.01642252691090107, -0.007144396658986807, -0.01255118753761053, -0.041052863001823425, 0.0019906884990632534, 0.02454473078250885, 0.04986274242401123, 0.05707641690969467, 0.038094766438007355, 0.09109897166490555, 0.02840929850935936, -0.006101537961512804, 0.008955268189311028, -0.006278399843722582, -0.0785231664776802, 0.04052003100514412, -0.05875677615404129, 0.057263027876615524, -0.05867408961057663, 0.007839920930564404, -0.033398862928152084, -0.0765238106250763, 0.0016774549148976803, 0.02872632071375847, 0.06813447922468185, 0.002575772814452648, 0.040697161108255386, -0.07183890789747238, -0.04839656502008438, 0.04421821981668472, 0.006196142639964819, 0.05843070521950722, -0.009627649560570717, 0.003803062252700329, 0.021068338304758072, -0.01599312387406826, -0.04548758640885353, 0.10425342619419098, -0.044755611568689346, 0.17273196578025818, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.11.output.dense" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158500>
      [0.10364681482315063, -0.061651408672332764, 0.03343866392970085, 0.06746673583984375, -0.06274823844432831, -0.008343202993273735, -0.04265935719013214, 0.008805698715150356, 0.02321832999587059, -0.12221553921699524, -0.02945561520755291, -0.03149624168872833, -0.06905896216630936, -0.02783670648932457, -0.05408920347690582, 0.02475467137992382, 0.058280233293771744, 0.053898636251688004, 0.035130951553583145, -0.01742079295217991, -0.009266539476811886, 0.010410315357148647, 0.06526799499988556, -0.0010279015405103564, -0.036657460033893585, -0.025987088680267334, 0.07862579822540283, 0.026940638199448586, -0.07205256819725037, 0.0583348423242569, 0.04130078852176666, 0.06464620679616928, -0.09915593266487122, -0.04434352368116379, -0.05582691729068756, 0.002493390114977956, -0.01684633083641529, -0.03094826079905033, 0.01066969521343708, 0.07622333616018295, -0.09326435625553131, -0.020401442423462868, 0.12255225330591202, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[3072][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158501>
      [
        [0.026321543380618095, -0.004627614747732878, -0.05093730613589287, -0.02473466284573078, 0.0033595398999750614, 0.005104986950755119, 0.05577652156352997, -0.009121284820139408, 0.013804575428366661, 0.07241109758615494, -0.07164449989795685, -0.03737146779894829, 0.047658346593379974, 0.08219514042139053, -0.013799983076751232, 0.02955007553100586, -0.02865609899163246, -0.012941383756697178, -0.0030501498840749264, 0.022440442815423012, -0.059222158044576645, -0.034289631992578506, -0.02480287291109562, 0.008628126233816147, 0.004632971249520779, 0.012318538501858711, -0.01161165814846754, 0.008858390152454376, 0.05292404070496559, 0.019926922395825386, -0.020519841462373734, 0.00781852938234806, -0.0073102181777358055, -0.02589130587875843, -0.006830563768744469, 0.034136466681957245, 0.010204183869063854, 0.023236269131302834, 0.004748895298689604, -0.030607547610998154, -0.015584939159452915, -0.019074248149991035, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.9.attention.self.key" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158618>
      [-0.0012274535838514566, 0.0037172024603933096, -0.0012906809570267797, -0.005185559391975403, 1.0579337686067447e-4, 0.005629525054246187, 3.749765164684504e-5, -0.01086893305182457, -9.729613084346056e-4, -0.00278106820769608, -9.496273123659194e-4, 0.0022558236960321665, 0.007978921756148338, -0.0013032881543040276, -5.822320817969739e-4, 0.0024968120269477367, 3.6918462137691677e-4, 0.003074175911024213, -0.0056000505574047565, -4.3052059481851757e-4, 0.0023288282100111246, 0.008348546922206879, -0.0014832367887720466, 6.44999323412776e-4, 0.007298830896615982, 0.003663078648969531, -0.010230637155473232, -4.5419062371365726e-4, -0.0037105174269527197, 0.012957315891981125, 0.001700310967862606, -2.2792642994318157e-4, -0.00233958987519145, -4.088415516889654e-5, 0.0029016337357461452, -0.0026827759575098753, 0.006074859760701656, -8.217979338951409e-4, -0.004525715485215187, -0.003362370887771249, 0.004684019833803177, -0.002680761506780982, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[768][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158619>
      [
        [0.06628668308258057, -0.0402645580470562, -9.560818434692919e-4, 0.05454331263899803, 0.013563195243477821, 0.0571771077811718, -0.04380969703197479, 0.052685219794511795, -0.019963620230555534, 0.029710816219449043, -0.023211589083075523, 0.00492983590811491, -0.05478765442967415, 0.010502735152840614, 0.009838690049946308, 0.007972369901835918, -0.05302092060446739, -0.006512594409286976, -0.007576362229883671, -0.06449495255947113, 0.080123670399189, 0.021186571568250656, -0.01808006502687931, 0.03337455913424492, -0.0355958454310894, -0.02282550185918808, 0.04034356400370598, -0.03548286482691765, 0.05198754370212555, -0.0415591336786747, -0.04024979844689369, -0.01791134662926197, -0.08158759027719498, -0.0506034754216671, 0.036053966730833054, 0.005422972608357668, -0.03631225973367691, 0.01564614102244377, 0.05912036448717117, 0.025296317413449287, -0.02547614835202694, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.6.intermediate.dense" => %{
    "bias" => #Nx.Tensor<
      f32[3072]
      EXLA.Backend<host:0, 0.446408219.3911319572.158576>
      [-0.03107498027384281, -0.03981218859553337, -0.06899973750114441, -0.08971962332725525, -0.039069823920726776, -0.025806155055761337, -0.032649025321006775, -0.08626752346754074, -0.05745439603924751, -0.032277412712574005, 0.03508985787630081, -0.17581240832805634, -0.045228492468595505, -0.024306645616889, -0.0653931200504303, -0.12080732733011246, -0.06221717968583107, -0.06462045758962631, -0.05387464538216591, -0.09864353388547897, -0.12879158556461334, -0.026321034878492355, -0.13178600370883942, -0.04580538719892502, -0.09312720596790314, -0.08066631108522415, -0.09477808326482773, -0.06168169528245926, -0.1487884819507599, -0.10899834334850311, -0.0536222979426384, -0.10156521201133728, -0.06633835285902023, -0.06911937892436981, -0.09369686990976334, -0.18287232518196106, -0.07745753228664398, -0.09062565118074417, -0.12181177735328674, -0.06049765646457672, -0.1031108871102333, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[768][3072]
      EXLA.Backend<host:0, 0.446408219.3911319572.158577>
      [
        [0.020890364423394203, -0.01711810752749443, -0.009326002560555935, 0.0385143980383873, 0.01857033558189869, 0.012439142912626266, -0.003994931001216173, 0.11158689856529236, -0.020984835922718048, -0.04497276246547699, -0.0033520490396767855, -0.05288152024149895, -0.0189614687114954, -0.04025958850979805, -0.02946152724325657, 0.040826618671417236, -0.10357397049665451, -0.028634510934352875, -0.04343373700976372, 0.07306626439094543, -0.026704858988523483, -2.611474774312228e-4, 0.03659167140722275, -0.10613894462585449, -0.02675456739962101, -0.023649632930755615, -0.05023794248700142, -0.06368716061115265, 0.0591006800532341, 0.03385976329445839, -0.06155651435256004, -0.014013389125466347, 0.0381876677274704, 0.028107900172472, 0.01800350286066532, -0.05310085788369179, 0.020182106643915176, -0.041831500828266144, -0.041744403541088104, -0.02830614149570465, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.10.attention.self.value" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158478>
      [-0.002559447893872857, 0.019136350601911545, 0.013403307646512985, 0.004801608622074127, 0.006997032091021538, -0.012825221754610538, 0.0013489759294316173, -0.01701081171631813, 0.01885366253554821, -0.004075134173035622, 0.0025557989720255136, -0.018384655937552452, -6.265421980060637e-4, -0.0034636519849300385, -9.403039002791047e-4, -0.012881244532763958, 0.010936018079519272, -0.0016692903591319919, 0.012519873678684235, -0.005010620225220919, 0.01120258029550314, 0.014463604427874088, 0.0052192192524671555, -0.005299936980009079, 0.006908155046403408, 0.005343269091099501, -0.004126096144318581, 0.010966831818223, 0.00907010305672884, -0.005032955668866634, 0.006778895854949951, 0.006917821709066629, 0.008158227428793907, -0.020170055329799652, -0.0036648770328611135, 0.003479247447103262, -0.004101070575416088, -0.004714206792414188, -0.01998351514339447, -0.004432282876223326, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[768][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158479>
      [
        [-0.003087143413722515, -0.02338368259370327, -0.05245542526245117, 0.010834225453436375, -0.021471530199050903, 0.014980819076299667, -0.0015587907982990146, 0.013585822656750679, 0.002878577448427677, 0.028811614960432053, -0.017985807731747627, -0.019715609028935432, -0.026239711791276932, 0.02245946228504181, -0.05462257191538811, -0.01103326864540577, 0.012910720892250538, 0.006853993982076645, -0.032103512436151505, 0.02108932100236416, -0.03332265093922615, 0.002788520185276866, -0.024338603019714355, -0.013677558861672878, -0.05253780633211136, 0.036326296627521515, 0.0013539210194721818, -0.037658676505088806, -0.11702284961938858, -0.006932377349585295, 0.02365967631340027, -0.06146934628486633, -0.04311235621571541, -0.017782937735319138, -0.0018050908111035824, 0.012132137082517147, -0.04934559762477875, -0.02714175172150135, 0.03102242387831211, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.0.intermediate.dense" => %{
    "bias" => #Nx.Tensor<
      f32[3072]
      EXLA.Backend<host:0, 0.446408219.3911319572.158448>
      [-0.07745096832513809, -0.065686896443367, -0.0627148225903511, -0.12345381826162338, -0.08114932477474213, -0.10915464907884598, -0.06160114333033562, -0.1201290637254715, -0.05143802985548973, -0.1131691262125969, -0.10104051977396011, -0.0947321429848671, -0.08409897983074188, -0.09157464653253555, -0.037428826093673706, -0.07909520715475082, -0.08496560901403427, -0.07232987135648727, -0.10774111747741699, -0.049252867698669434, -0.007425958290696144, -0.057002827525138855, -0.05439369007945061, -0.07114596664905548, -0.10188410431146622, -0.08844968676567078, -0.035555023699998856, -0.12305380403995514, -0.06208236142992973, -0.07923329621553421, -0.030422599986195564, -0.04481087625026703, -0.05104590952396393, -0.06848461925983429, -0.07581157982349396, -0.061208318918943405, -0.04116049036383629, -0.06431341171264648, -0.10766587406396866, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[768][3072]
      EXLA.Backend<host:0, 0.446408219.3911319572.158449>
      [
        [0.00908915139734745, 0.04040137305855751, -0.03324820473790169, 0.00866289995610714, 0.009394424967467785, -0.024154750630259514, -0.10892899334430695, -0.00911347009241581, -0.007274097763001919, 0.010723236948251724, -0.023106446489691734, 0.03274473175406456, 6.947365473024547e-4, 0.028022048994898796, 0.004835015628486872, -0.02512173168361187, -0.024481602013111115, -0.0495920293033123, 0.005475334357470274, 0.041790276765823364, -0.025792237371206284, -0.01534793060272932, 0.0038137042429298162, -0.007708685472607613, 0.0034625278785824776, 0.020273268222808838, -0.010432980954647064, 0.015027872286736965, 0.02899545058608055, -0.052503764629364014, 0.03751338645815849, -0.09724695235490799, -0.07326369732618332, 0.03746408969163895, 0.02697257325053215, 0.03337589651346207, -0.008162134326994419, -0.0276561938226223, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.6.attention.output.LayerNorm" => %{
    "beta" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158566>
      [0.004530088510364294, -0.11398780345916748, -0.156212717294693, 0.1150607168674469, -0.07826890051364899, 0.020715652033686638, -0.1933673471212387, 0.12144610285758972, 0.0924220085144043, -0.05385386571288109, 0.05941833555698395, -0.018917487934231758, -0.06889031827449799, -0.13267011940479279, 0.010953256860375404, 0.16273309290409088, 0.008181087672710419, -0.0664462298154831, -0.13482683897018433, -0.06492046266794205, 0.040627043694257736, 0.06327785551548004, 0.010658404789865017, 0.0467333048582077, -0.10572876781225204, 0.04595961049199104, 0.08023229986429214, 0.17528903484344482, 0.06690476089715958, -0.006582128349691629, -0.059387724846601486, -0.028289828449487686, -0.10552085191011429, -0.04139881581068039, 0.015296202152967453, 0.042052656412124634, -0.11462461203336716, 0.038055215030908585, ...]
    >,
    "gamma" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158567>
      [0.9174342751502991, 0.9260887503623962, 0.9273979663848877, 0.9183933138847351, 0.9314171671867371, 0.8951204419136047, 0.862395703792572, 0.8727104067802429, 0.9392297267913818, 0.8549071550369263, 0.9738189578056335, 0.9533886313438416, 0.9774797558784485, 0.9564791321754456, 0.9452900886535645, 0.8063921332359314, 0.8828117251396179, 0.9152967929840088, 0.9019017815589905, 0.9202021360397339, 0.874483048915863, 0.9796283841133118, 0.8985503315925598, 0.9081827998161316, 0.8987912535667419, 0.9368417263031006, 0.9440268278121948, 0.9547653794288635, 0.9282682538032532, 0.9378321766853333, 0.9341272711753845, 0.8228398561477661, 0.9517443180084229, 0.8387966752052307, 0.8988194465637207, 0.9163835048675537, 0.8426492810249329, ...]
    >
  },
  "bert.encoder.layer.3.attention.self.key" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158522>
      [-4.43523982539773e-4, 0.0011028022272512317, 0.0018408572068437934, 4.257326072547585e-4, -0.0026361935306340456, -0.0019880072213709354, -9.509099763818085e-4, 5.746788810938597e-4, 0.0014274438144639134, 0.0018733326578512788, -0.0010124077089130878, -8.718111203052104e-4, 3.0121326562948525e-4, 6.718431250192225e-4, -3.892293607350439e-4, -7.129214936867356e-4, 2.0820410281885415e-4, -8.583918679505587e-4, -0.0017300014151260257, 8.305213414132595e-4, 3.5952520556747913e-4, 0.0035711226519197226, 0.0014929480385035276, 3.0810220778221264e-5, 8.4163952851668e-4, 0.0013253124197944999, -0.003480408573523164, -0.0027907078620046377, -0.0019091047579422593, 0.0019175815396010876, 5.056363297626376e-4, -3.8150616455823183e-4, -9.006308391690254e-4, -1.3010583643335849e-5, 0.0010428045643493533, -0.0018518861616030335, -7.208447786979377e-4, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[768][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158523>
      [
        [-0.05042904615402222, -0.011265779845416546, 0.010547528974711895, 0.060243070125579834, -0.012970632873475552, 0.03335720673203468, 0.0035944078117609024, 0.01832611672580242, 0.07395190745592117, -0.04017460718750954, 0.01083382312208414, 0.01773049309849739, -0.06244435906410217, -0.02956821769475937, -0.04923847317695618, 0.03824516385793686, -0.012110898271203041, 0.03320696949958801, -0.03790261596441269, -0.040309157222509384, 0.035207200795412064, 0.010284604504704475, 0.019847137853503227, -0.004635897930711508, 0.0282080490142107, 0.005289111752063036, -0.032857369631528854, -0.06130319833755493, 0.06318983435630798, -0.029263010248541832, 0.037022899836301804, -0.05305516719818115, 0.0055113304406404495, 0.023156268522143364, -0.018086574971675873, 0.011352784000337124, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.0.attention.self.query" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158444>
      [-0.6387335062026978, 0.4724082052707672, -0.19521036744117737, -0.11605856567621231, -0.11748603731393814, -0.1825280487537384, 0.18115843832492828, -0.027512650936841965, -0.19060389697551727, 0.13271184265613556, -0.42587924003601074, -0.21953780949115753, -0.4006114900112152, -0.10228057205677032, 0.34728768467903137, 0.14518485963344574, -0.2332526594400406, 0.019963528960943222, -0.17081336677074432, 0.23993250727653503, -0.2678239047527313, -0.21631677448749542, 0.3732489049434662, -0.14452169835567474, 0.38097646832466125, 0.1346377283334732, -0.3692803382873535, 0.08560264855623245, 0.13854672014713287, 0.16373662650585175, 0.3647611439228058, -0.30625244975090027, -0.1198020726442337, -0.1964799165725708, 0.22727882862091064, -0.4538043141365051, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[768][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158445>
      [
        [-0.029768871143460274, 0.022128330543637276, -0.025022896006703377, -0.00855762418359518, -0.009525594301521778, 0.04139768332242966, 0.02911439538002014, -0.018351467326283455, -0.004022249951958656, -0.024658720940351486, 0.08884090185165405, 0.04140271618962288, 0.030540145933628082, -0.01689596101641655, 0.049857139587402344, -0.0228058360517025, -0.00890139676630497, -0.04317929595708847, 0.10173530876636505, 0.02341497130692005, -0.011801376938819885, 0.020865008234977722, 0.02749180607497692, 0.005914455745369196, 0.03664044663310051, 0.02228805236518383, -0.04925498738884926, 0.0058151716366410255, 0.032251425087451935, -0.004501311108469963, 0.05893097072839737, -0.08533360064029694, -0.0025154880713671446, 0.011578072793781757, 0.02870110236108303, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.9.output.dense" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158628>
      [0.057664744555950165, -0.09629920870065689, -0.06553075462579727, 0.11631593853235245, -0.04101669415831566, -0.0824797973036766, -0.022207587957382202, 0.04904678836464882, -0.0032810454722493887, -0.035539064556360245, 0.0146945770829916, -0.009445366449654102, -0.05316465348005295, 0.07357398420572281, 0.029361754655838013, 0.049359481781721115, -0.08306986838579178, -0.07369628548622131, -0.029040278866887093, -0.010439747013151646, -0.020529963076114655, 0.0593094564974308, 0.04466358199715614, 0.039762988686561584, -0.08494578301906586, -0.07048505544662476, -7.038580370135605e-4, 0.14512553811073303, 0.1363646239042282, 0.03879605978727341, -0.03884206712245941, -3.6977764102630317e-4, -0.05711204558610916, -0.030075233429670334, 0.1041066125035286, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[3072][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158629>
      [
        [-0.03660743311047554, -0.005957311484962702, -0.006265013478696346, -0.016829989850521088, -0.028377391397953033, -0.004497631918638945, 0.024349533021450043, -0.011968612670898438, 0.009198236279189587, -0.006416493561118841, 0.04030259698629379, -0.010050900280475616, -0.0060271453112363815, 0.00525992177426815, -0.015193678438663483, -0.015114296227693558, -0.023395372554659843, -0.02779638022184372, 0.0359886959195137, -0.07023241370916367, -0.00726299500092864, -0.033704034984111786, 0.00597715750336647, 0.022157251834869385, 0.0122749088332057, -0.01904052309691906, -0.03000371716916561, 0.01731731928884983, -2.2746175091015175e-5, -0.01804925873875618, -0.03331908583641052, -0.020781293511390686, 0.02208474464714527, -0.028800271451473236, ...],
        ...
      ]
    >
  },
  "bert.embeddings.LayerNorm" => %{
    "beta" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158433>
      [-0.00875217467546463, -0.012545009143650532, -0.04576732590794563, -0.03967990726232529, 0.0335424467921257, -0.05538113787770271, 0.03823651373386383, -0.16746686398983002, -0.003543569939211011, -0.062118254601955414, 0.021382441744208336, -0.02176540158689022, -0.01627258211374283, -0.02002585679292679, -0.009960811585187912, -0.1082875058054924, -0.010108714923262596, -0.04679981991648674, -0.002659041667357087, 0.012200873345136642, -0.03449040278792381, 0.018006732687354088, -0.06052204221487045, -0.04727131128311157, -0.0774466022849083, 0.016658516600728035, -0.06670530140399933, -0.06577882170677185, 0.038620725274086, 0.0017636348493397236, -0.01276316400617361, 0.443447083234787, -0.039219632744789124, -0.05068201944231987, ...]
    >,
    "gamma" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158434>
      [0.9254664778709412, 0.906049907207489, 0.9289418458938599, 0.8996816873550415, 0.8201596140861511, 0.913253128528595, 0.6487036347389221, 0.6655523777008057, 0.9447330832481384, 0.8495482802391052, 0.9161603450775146, 0.9097179770469666, 0.9659318327903748, 0.919485867023468, 0.9189836382865906, 0.548558235168457, 0.9338418841362, 0.9008424878120422, 0.8842005133628845, 0.9102588295936584, 0.8071944713592529, 0.9381183981895447, 0.9271243810653687, 0.9100289940834045, 0.8564289808273315, 0.867300808429718, 0.9201399087905884, 0.9087300896644592, 0.8985592126846313, 0.9309773445129395, 0.9225252866744995, 0.16041572391986847, 0.9215646982192993, ...]
    >
  },
  "bert.encoder.layer.2.output.dense" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158516>
      [-0.024508202448487282, -0.02445383369922638, 0.002527947537600994, -0.008290639147162437, -0.03359556198120117, 0.08855681121349335, 0.028853533789515495, 0.08278404176235199, 0.005615088623017073, -0.011701268143951893, 0.04961547628045082, 0.04660194367170334, -0.02148023433983326, -0.08207909762859344, -0.013150672428309917, 0.12008630484342575, 0.024183155968785286, 0.021064799278974533, 0.015624077059328556, -0.0446697436273098, 0.050561510026454926, 0.039321038872003555, -0.0038633618969470263, 0.002277206629514694, -0.11235672980546951, -0.03425103798508644, -0.02605750411748886, 0.02174045704305172, 0.03278709203004837, -0.001054515945725143, 0.007367465179413557, -0.00873570330440998, -4.126520361751318e-4, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[3072][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158517>
      [
        [-0.016676034778356552, 0.01599922589957714, -0.016283446922898293, 0.02747274935245514, -0.014998309314250946, -0.004835977219045162, 0.03410448133945465, 0.0181126706302166, -0.013997858390212059, -0.018957482650876045, 0.018756281584501266, -0.005047094542533159, 0.02276851050555706, 0.006836008280515671, 0.016818778589367867, -0.01800871267914772, -0.0020583912264555693, 0.06258303672075272, 0.051416561007499695, -0.037852395325899124, 0.004408612381666899, -0.02963091805577278, -0.021190572530031204, 0.023921769112348557, 0.02386590838432312, 0.008580546826124191, 0.0011606072075664997, 0.03658357262611389, -0.0291020255535841, -0.03257417306303978, -0.06366810947656631, 0.005832058377563953, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.7.attention.output.dense" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158584>
      [-0.039697516709566116, -0.0013434862485155463, 0.07027216255664825, 0.0011240217136219144, 0.043345946818590164, 0.03266070410609245, 0.09632443636655807, 0.03669102117419243, 0.016249127686023712, -0.021884381771087646, 0.025029363110661507, 0.003519034245982766, 0.00777832604944706, 0.058444902300834656, -0.0352921336889267, 0.0032828841358423233, 0.020608482882380486, 0.019800907000899315, 0.06778910756111145, -0.048523902893066406, 0.09212983399629593, -0.06420625746250153, 0.012532909400761127, -0.0016008458333089948, 0.04040566831827164, -0.08889023214578629, -0.04368266463279724, -0.08095256239175797, 0.040884170681238174, -0.024095050990581512, 0.023553594946861267, 4.9979193136096e-4, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[768][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158585>
      [
        [0.023680979385972023, -0.03634810075163841, 0.02004745975136757, 0.027979236096143723, -0.011385468766093254, 0.015109594911336899, 0.029329346492886543, -0.018501121550798416, 0.005289522465318441, -0.05614364519715309, -0.00821839552372694, -0.015758713707327843, 0.030098725110292435, -0.019880356267094612, -0.006096164230257273, -0.03826029598712921, 0.008478322997689247, -0.0016384315676987171, 0.025180213153362274, 0.013043480925261974, -0.005248915404081345, -0.03402676060795784, 0.0394744947552681, 0.041159071028232574, 0.0025610814336687326, -0.0017256047576665878, 0.004917862359434366, 0.021238423883914948, 0.03521951660513878, 0.004896581172943115, 0.01152892503887415, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.10.attention.self.query" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158476>
      [0.026748517528176308, -0.008895231410861015, -0.046853624284267426, -0.017237573862075806, 0.007558990735560656, -0.016819674521684647, -0.041237618774175644, -0.008936095982789993, -0.023859508335590363, 0.019181760028004646, 0.08299721032381058, -8.334474405273795e-4, 0.008630243130028248, 0.015212707221508026, 0.04155111685395241, 0.010459838435053825, 0.022246593609452248, -0.03991435468196869, -0.0294125247746706, 0.007991386577486992, 0.0030571003444492817, 0.022745393216609955, 0.01863151602447033, 0.03493468090891838, -0.02404540590941906, 0.006460430566221476, -0.012676509097218513, -0.008618115447461605, 0.006774778012186289, -0.004022771026939154, -0.006096129771322012, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[768][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158477>
      [
        [0.008326323702931404, 0.04005397856235504, 0.0023991151247173548, 0.04807410389184952, -0.04100289195775986, -0.09143573045730591, -0.03084658272564411, 8.747376268729568e-4, -0.11215519160032272, 0.04893479868769646, 0.009506823495030403, -0.01728687807917595, 0.0677281990647316, -0.007382004987448454, 0.005440958775579929, -0.005196533631533384, -0.03617476671934128, -0.029538806527853012, -0.044383250176906586, 0.012153849937021732, 0.035129256546497345, 0.04092898592352867, 0.038464296609163284, 3.8578722160309553e-4, 0.006683974526822567, -0.06365974247455597, 0.019042277708649635, 0.03581710159778595, 0.04884197562932968, 0.008019009605050087, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.1.intermediate.dense" => %{
    "bias" => #Nx.Tensor<
      f32[3072]
      EXLA.Backend<host:0, 0.446408219.3911319572.158464>
      [-0.0673687532544136, -0.08779805898666382, -0.09198816120624542, -0.12600243091583252, -0.009623662568628788, -0.06377726793289185, -0.08302489668130875, -0.10164520144462585, -0.07807774841785431, -0.09791939705610275, -0.07027985900640488, -0.08257396519184113, -0.01998441480100155, -0.05887303128838539, -0.104843869805336, -0.09357360005378723, -0.07023440301418304, -0.042372141033411026, -0.06596823781728745, -0.08593371510505676, -0.07275370508432388, -0.06370159983634949, -0.06921545416116714, -0.06004379317164421, -0.005473697558045387, -0.06716224551200867, -0.0726865902543068, -0.08096443861722946, -0.10494089871644974, -0.0631396621465683, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[768][3072]
      EXLA.Backend<host:0, 0.446408219.3911319572.158465>
      [
        [0.019307631999254227, 0.02609732747077942, 0.026455961167812347, -0.014183434657752514, -0.0029642870649695396, 0.07662734389305115, -0.0017839429201558232, -0.0330573171377182, -0.013116449117660522, 0.022742582485079765, -0.03331121802330017, -0.016591135412454605, 0.006606966257095337, -0.0017921192338690162, -0.011434145271778107, -0.06094913184642792, -0.07820641249418259, -0.0360814593732357, 0.02027858793735504, -0.003944426774978638, 0.0019531190628185868, 0.02595360204577446, -0.006152613088488579, -0.003330546198412776, -0.024865318089723587, -0.04790664464235306, -0.04982195794582367, 0.05011887103319168, -0.016450276598334312, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.8.attention.self.query" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158604>
      [-0.03144920989871025, 0.02036363258957863, 0.140531525015831, -0.04615453630685806, -0.04338375851511955, -0.15450754761695862, -0.12571150064468384, -0.04473801702260971, 0.09130976349115372, 0.008007416501641273, 0.010838517919182777, 0.020390158519148827, -0.013402334414422512, -0.09764692932367325, -0.03659231215715408, 0.014969143085181713, 0.18654294312000275, 0.049247339367866516, 0.06962905824184418, 0.0323602557182312, 0.014847837388515472, 0.18944717943668365, -0.09933116286993027, 0.023198960348963737, -0.1114208847284317, -0.041745129972696304, -0.01581585220992565, 0.11099159717559814, 0.29675954580307007, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[768][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158605>
      [
        [0.0015605621738359332, -0.07420892268419266, -0.03087863326072693, 0.04659470543265343, -0.09376730024814606, 0.06580080091953278, -0.041754793375730515, -0.005407425109297037, 0.06778361648321152, 0.031187117099761963, 0.11305532604455948, 0.026780273765325546, -0.033068493008613586, 0.025781014934182167, -0.026028543710708618, -0.04441336914896965, -0.07058597356081009, 0.0010137236677110195, -0.0010000623296946287, -0.08550504595041275, 0.08058342337608337, 0.0015628349501639605, -0.0404655858874321, 4.7489651478827e-4, -0.07377834618091583, -0.017880838364362717, -0.03859153762459755, -0.026219442486763, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.4.attention.self.query" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158540>
      [-0.16285434365272522, -0.015277131460607052, 0.26668885350227356, 0.45720410346984863, -0.16157317161560059, 0.09592696279287338, -0.14075976610183716, -0.06824823468923569, 0.24686427414417267, 0.3066250681877136, 0.3533056974411011, 0.12028995156288147, 0.03265313431620598, 0.018452977761626244, 0.0452493354678154, -0.03452266752719879, 0.1089940145611763, -0.1385095715522766, -0.13148564100265503, 0.07527884840965271, -0.06857304275035858, 0.003329840023070574, -0.034099068492650986, -0.11507805436849594, 0.1227710023522377, -0.19782672822475433, -0.2704467475414276, 0.15136116743087769, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[768][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158541>
      [
        [-0.03688031807541847, 0.037983182817697525, -0.017330370843410492, -0.0012140099424868822, 0.024621933698654175, 0.012365204282104969, -0.027447214350104332, -0.03619808703660965, -0.03422901779413223, -0.020599858835339546, -0.012030906043946743, -0.0762656107544899, 0.006277609150856733, 0.03547125682234764, 0.018742796033620834, 0.04784705862402916, -0.10897969454526901, -0.0953519195318222, 0.02261844091117382, -0.021292172372341156, -0.007767158560454845, 0.05882410705089569, 0.00373574486002326, -0.03393683210015297, -0.04657900333404541, -0.06049340218305588, 0.011078632436692715, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.10.output.LayerNorm" => %{
    "beta" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158482>
      [-0.08356893062591553, 0.021916719153523445, -0.03639497235417366, -0.04466509819030762, -5.397343193180859e-4, -0.025936821475625038, -0.011704521253705025, -0.04003811627626419, -0.03468015789985657, 0.012214087881147861, -0.03878331929445267, -0.06917792558670044, 0.004522230941802263, -0.052043184638023376, -0.032723281532526016, -0.01730307936668396, -0.025787774473428726, -0.034718647599220276, 0.005020328797399998, 0.007779334206134081, -0.040076494216918945, -0.024512752890586853, -0.028166186064481735, -0.021768271923065186, -0.05209912359714508, -5.429010489024222e-4, -0.04106122627854347, ...]
    >,
    "gamma" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158483>
      [0.9127042889595032, 0.9182067513465881, 0.9460157752037048, 0.9116032719612122, 0.921282947063446, 0.9004127979278564, 0.8737766146659851, 0.9255651235580444, 0.9471142888069153, 0.8831844925880432, 0.9466231465339661, 0.9588955640792847, 0.9501218199729919, 0.9614825248718262, 0.9590829610824585, 0.894162118434906, 0.9319353699684143, 0.9129297733306885, 0.9321860671043396, 0.93180912733078, 0.9429530501365662, 0.94203120470047, 0.9360920190811157, 0.9407057166099548, 0.945766806602478, 0.9323743581771851, ...]
    >
  },
  "bert.encoder.layer.2.attention.self.query" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158508>
      [0.0012907672207802534, 0.02213454619050026, 0.005410699639469385, 0.004569768439978361, -3.935476124752313e-4, -0.016201214864850044, 0.015436134301126003, -0.024876005947589874, 0.0036440177354961634, -0.05703825131058693, -0.013124506920576096, 0.0039266543462872505, 0.012259413488209248, -0.03944789990782738, -0.04544312134385109, 0.009596033953130245, -0.013626495376229286, -0.014490506611764431, -0.007753962650895119, 0.00464417040348053, 0.08115974068641663, 0.010813755914568901, -0.02440750226378441, 0.024004420265555382, -0.002426475752145052, 0.015680961310863495, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[768][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158509>
      [
        [-0.017359169200062752, 0.009427312761545181, 0.03244992718100548, -0.0047462028451263905, 0.028234876692295074, -0.03603716194629669, -0.006021881476044655, 0.024873757734894753, -0.007833059877157211, 0.008321058005094528, -3.6271559656597674e-4, 0.054931286722421646, 0.0286251250654459, 0.019659025594592094, -0.0463750958442688, -0.004838396329432726, 0.056372176855802536, -0.02088429033756256, -0.027993664145469666, 0.027339335530996323, 0.0366557314991951, 0.014924452640116215, -0.05646943673491478, -0.018969746306538582, -0.09373301267623901, ...],
        ...
      ]
    >
  },
  "bert.embeddings.word_embeddings" => %{
    "kernel" => #Nx.Tensor<
      f32[28996][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158437>
      [
        [-5.478383391164243e-4, -0.041568856686353683, 0.013083661906421185, 0.005755499936640263, -0.037633221596479416, 0.013274767436087132, 0.08125533163547516, 0.05623384192585945, -0.017871497198939323, 0.020253799855709076, -0.0322672575712204, -0.039308100938797, -0.024024227634072304, 0.008347730152308941, -0.016084467992186546, 0.0955670028924942, -0.014709480106830597, -0.04485480859875679, -0.03949921205639839, -0.03551776707172394, -0.08413833379745483, -0.03968473896384239, 0.02032049000263214, 0.0037535487208515406, -0.01960371434688568, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.3.attention.output.LayerNorm" => %{
    "beta" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158518>
      [0.05432829260826111, 0.018252795562148094, -0.1243981346487999, -0.026910042390227318, -0.0920039638876915, 0.14866399765014648, -0.12204346805810928, 0.28352829813957214, 0.14666520059108734, -0.020148441195487976, 0.11379420757293701, 0.003779646474868059, -0.014843297190964222, -0.124735988676548, 0.0024914410896599293, 0.22332805395126343, -0.03446513041853905, -0.02470497414469719, -0.05140624940395355, -0.07460618764162064, 0.03847324103116989, 0.0814804881811142, -0.06472178548574448, 0.07118584960699081, ...]
    >,
    "gamma" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158519>
      [0.9463558197021484, 0.9228172898292542, 0.9419609308242798, 0.918046236038208, 0.8907944560050964, 0.9220505356788635, 0.8803371787071228, 0.943317174911499, 0.9627458453178406, 0.9058472514152527, 0.9610707759857178, 0.9433343410491943, 0.9566006660461426, 0.9390245079994202, 0.9356873035430908, 0.8623889684677124, 0.9089118838310242, 0.9100931286811829, 0.9086135625839233, 0.9514665603637695, 0.9285305142402649, 0.9613152146339417, 0.9241238236427307, ...]
    >
  },
  "bert.encoder.layer.0.output.LayerNorm" => %{
    "beta" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158450>
      [0.030751073732972145, -0.11637488007545471, -0.03650762513279915, -0.03316624462604523, 0.0021663415245711803, -0.042864080518484116, 0.17079609632492065, -0.07671315222978592, -0.050283435732126236, -0.05910322442650795, -0.00433438690379262, -0.10377907007932663, -0.05494621396064758, -0.07217715680599213, -0.050340406596660614, -0.11422596126794815, -0.005837741773575544, -0.052490584552288055, -0.05279337614774704, -0.03783890977501869, -0.1513892263174057, -0.08683758229017258, -0.013181856833398342, ...]
    >,
    "gamma" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158451>
      [0.9029600024223328, 0.8976031541824341, 0.9095702767372131, 0.8988170623779297, 0.8737949728965759, 0.9093321561813354, 0.779732346534729, 0.7860512137413025, 0.9293753504753113, 0.8589790463447571, 0.9286658763885498, 0.9024710655212402, 0.9431872367858887, 0.9210516810417175, 0.927026629447937, 0.752564549446106, 0.9223776459693909, 0.9027895927429199, 0.8952163457870483, 0.9142012596130371, 0.8495844006538391, 0.9053725004196167, ...]
    >
  },
  "bert.encoder.layer.8.attention.self.value" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158606>
      [-0.016164809465408325, 1.2740949750877917e-4, -0.013240676373243332, -0.01195200253278017, 0.06784292310476303, -0.02143295668065548, -0.0602579303085804, 0.03016602247953415, 0.019803069531917572, -0.009509638883173466, -0.010207179933786392, 0.01708512380719185, -0.045895062386989594, 0.017641454935073853, 0.016229795292019844, -0.06387689709663391, -0.0012722352985292673, 0.022882023826241493, 0.056457627564668655, -0.004184508230537176, 0.06392952054738998, 0.002208516001701355, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[768][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158607>
      [
        [-0.048459675163030624, 0.020938538014888763, -0.03705829754471779, 0.04019823297858238, -0.011398778297007084, 0.07011996954679489, 0.04104074090719223, -0.008943566121160984, 0.022499101236462593, -0.017016148194670677, -0.053760264068841934, -0.048628345131874084, -0.05253184959292412, -0.05571015924215317, 0.0036218995228409767, -0.015263817273080349, 0.05378734692931175, 0.036894481629133224, -0.00968257151544094, 0.04599836841225624, -0.0036924888845533133, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.1.attention.self.value" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158462>
      [-0.001039390335790813, -0.00454203924164176, -0.01047802995890379, 0.010112632997334003, -0.018030580133199692, 0.0014493721537292004, 0.005496451165527105, 0.007770768366754055, -0.004404380451887846, -0.012885707430541515, 0.008710264228284359, -0.019836068153381348, 0.02578706108033657, 0.022170979529619217, 0.0013307675253599882, -0.003765468718484044, -0.009896870702505112, -0.001102394424378872, -0.002976935589686036, -0.0020949034951627254, 0.010102424770593643, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[768][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158463>
      [
        [0.017657766118645668, 0.041356030851602554, -0.021042533218860626, 0.004673115909099579, 0.013914050534367561, -0.040270544588565826, -0.020329469814896584, -0.03910331428050995, -0.05137667804956436, -0.011874979361891747, -0.029288876801729202, -0.0029113409109413624, -0.02684074081480503, 0.0010629830649122596, -0.003418599721044302, 0.014950408600270748, 0.004397254437208176, -0.010664206929504871, 0.017842687666416168, -0.031016845256090164, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.9.attention.output.LayerNorm" => %{
    "beta" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158614>
      [0.04121429845690727, -0.12548723816871643, -0.08411962538957596, 0.141917422413826, -0.03638221323490143, -0.03641945868730545, -0.08710656315088272, 0.06253424286842346, 0.010496122762560844, -0.052617356181144714, 0.009884407743811607, 0.003998745232820511, -0.052219685167074203, 0.011503724381327629, 0.0547686368227005, 0.08714287728071213, -0.06959347426891327, -0.11609162390232086, -0.1047854945063591, -0.05322733521461487, ...]
    >,
    "gamma" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158615>
      [0.9214925765991211, 0.9104549884796143, 0.9096371531486511, 0.9081160426139832, 0.9003007411956787, 0.8635414242744446, 0.8726057410240173, 0.865135133266449, 0.9033907055854797, 0.8829386830329895, 0.9063257575035095, 0.914730429649353, 0.9305427670478821, 0.908677875995636, 0.9004797339439392, 0.8356059789657593, 0.8774005174636841, 0.8683241605758667, 0.9002323150634766, ...]
    >
  },
  "bert.encoder.layer.10.output.dense" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158484>
      [0.07929817587137222, -0.09527000784873962, -0.060944873839616776, 0.1361190676689148, -0.05617288127541542, -0.0833020806312561, -0.11663619428873062, 0.06583438068628311, 0.06049564853310585, -0.07819177210330963, 0.022520042955875397, -0.029265940189361572, -0.043723054230213165, 0.042212922126054764, 0.0037949199322611094, 0.07725126296281815, -0.018130239099264145, -0.06708215177059174, 0.00954877957701683, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[3072][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158485>
      [
        [-0.00549967959523201, 0.017219126224517822, -0.018350521102547646, -0.04174015671014786, 0.04817626252770424, 0.01432564202696085, -0.019677292555570602, 0.005613209214061499, 0.04063786566257477, -0.007651756051927805, 0.03948632627725601, 0.011856012046337128, 0.014850713312625885, -0.028968578204512596, 0.00665869377553463, -0.013558155857026577, 0.03350913152098656, 0.045263323932886124, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.0.output.dense" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158452>
      [0.01592685841023922, 0.036139607429504395, -0.017149608582258224, 0.07348413020372391, 0.015097410418093204, 0.10349778831005096, 0.04548412933945656, 0.06325876712799072, -0.012926855124533176, -0.042089659720659256, 0.09560728818178177, 0.030344344675540924, 0.01995801366865635, -0.07037303596735, 0.0062188999727368355, 0.16775023937225342, -8.346334798261523e-4, -0.025388317182660103, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[3072][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158453>
      [
        [0.01045503094792366, -0.014966439455747604, -0.007512324955314398, 0.03388165682554245, 0.07404723763465881, 0.029774410650134087, -0.03419996798038483, -0.025402486324310303, -0.021258652210235596, 0.07575147598981857, 0.004132252652198076, -0.06518824398517609, -0.06949073821306229, -0.011835259385406971, -0.04032156988978386, -0.01140658464282751, 0.0076606133952736855, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.3.attention.output.dense" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158520>
      [0.020833227783441544, 0.04109243303537369, -0.03495034575462341, 0.025186091661453247, 0.03874297812581062, 0.11664289236068726, 0.07396840304136276, -0.06952736526727676, -0.01586732268333435, -0.05287725850939751, 0.014006941579282284, 0.048376698046922684, 0.026004185900092125, 0.04725952446460724, -0.014857918955385685, 0.020217619836330414, 0.02593390643596649, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[768][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158521>
      [
        [-4.82075905892998e-4, 0.004778942093253136, -0.041379716247320175, -0.015912001952528954, -0.03632909432053566, 0.002254561521112919, -0.02312328852713108, -0.006851157173514366, 0.03798481822013855, -0.03899857774376869, 0.005067779682576656, -0.02327100746333599, 0.018952900543808937, 0.01450805552303791, -0.04185855761170387, 0.003949596080929041, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.11.output.LayerNorm" => %{
    "beta" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158498>
      [0.022228745743632317, -0.021296193823218346, -5.833578179590404e-4, -0.028966277837753296, -0.0297144316136837, 0.024369191378355026, -0.010433990508317947, -0.08372549712657928, 0.03132764995098114, -0.06998816132545471, -0.0259509589523077, 0.003999519627541304, -0.07341305166482925, -0.0013237561797723174, -0.08275427669286728, 0.006763298995792866, ...]
    >,
    "gamma" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158499>
      [0.7324495911598206, 0.7459707260131836, 0.7464388608932495, 0.7252549529075623, 0.7465063333511353, 0.7480534911155701, 0.7615939378738403, 0.7351632714271545, 0.783883273601532, 0.7064502239227295, 0.7472440004348755, 0.747993528842926, 0.8038434982299805, 0.7309026122093201, 0.7196406126022339, ...]
    >
  },
  "bert.encoder.layer.4.output.dense" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158548>
      [-0.01101446058601141, -0.01438586600124836, -0.04286292940378189, 0.002360415644943714, -0.039802853018045425, 0.057273879647254944, -0.0236966535449028, 0.06798457354307175, 0.0023249357473105192, -0.043170224875211716, 0.0578186996281147, 0.014297638088464737, -0.04398912563920021, -0.06670442223548889, 0.002784664509817958, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[3072][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158549>
      [
        [-0.054392654448747635, -0.023719288408756256, -0.0198799017816782, 0.009688762947916985, 0.08397317677736282, 0.03823092579841614, 0.03006521612405777, 0.001725215814076364, -0.039357300847768784, -0.022647470235824585, -0.02999926544725895, 0.01683139055967331, 0.027991803362965584, 0.05073009803891182, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.0.attention.self.key" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158442>
      [-4.5197809231467545e-4, 6.399464327841997e-4, -1.3730188948102295e-4, -4.4623814756050706e-4, -4.8481710837222636e-4, 8.513302309438586e-4, -6.256758933886886e-4, 7.724041934125125e-4, -4.645788576453924e-4, 4.826900258194655e-4, 1.0049596312455833e-4, -7.477711187675595e-4, -0.0014649509685114026, -3.674174949992448e-4, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[768][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158443>
      [
        [0.030832163989543915, 0.0037570749409496784, 0.05049838498234749, -0.039383016526699066, 0.002697312505915761, -0.002244652481749654, 0.002726886188611388, -0.04161275550723076, -0.010435475967824459, -0.017568660899996758, -0.06973375380039215, -0.06304525583982468, -0.008176996372640133, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.9.output.LayerNorm" => %{
    "beta" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158626>
      [-0.08383016288280487, 0.048623330891132355, -0.026268912479281425, -0.06616897135972977, 0.0027583197224885225, -0.10253620892763138, 0.0239414032548666, -0.06244569644331932, -0.04772864282131195, 0.04251865670084953, -0.0857633724808693, -0.021947989240288734, -0.004206984303891659, ...]
    >,
    "gamma" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158627>
      [0.9086700081825256, 0.9274057149887085, 0.9315767288208008, 0.9141560792922974, 0.9440012574195862, 0.9338958263397217, 0.8908562064170837, 0.9239331483840942, 0.9245977997779846, 0.9050204157829285, 0.9406368136405945, 0.9312922358512878, ...]
    >
  },
  "bert.encoder.layer.2.attention.output.dense" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158504>
      [-0.04844393953680992, 0.008151722140610218, -0.06623199582099915, 0.03263704851269722, 0.22569628059864044, -0.001993372570723295, -0.07537593692541122, -0.06185075268149376, 0.0022020323667675257, -0.04131864383816719, 0.017074348405003548, -0.0030732040759176016, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[768][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158505>
      [
        [0.03080093301832676, -0.004302076995372772, -0.011649064719676971, -0.03748825564980507, 2.8147161356173456e-4, -0.005710023920983076, -0.01945834793150425, -0.02196967415511608, -0.03293922170996666, 0.0580032579600811, -0.04021724686026573, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.5.attention.self.value" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158558>
      [0.01958494819700718, -0.0016188874142244458, 3.95914503314998e-6, 0.002274481114000082, 0.019067935645580292, 0.0025952698197215796, 0.006262204609811306, -0.008278890512883663, -0.0036645643413066864, 0.014868204481899738, -5.816327757202089e-4, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[768][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158559>
      [
        [-0.030915889889001846, 0.026120943948626518, -0.0032871996518224478, -0.01068436075001955, 0.010748069733381271, -0.009175678715109825, -0.008407165296375751, 0.00199943408370018, 0.04268379881978035, 0.03667076677083969, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.8.attention.output.dense" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158600>
      [-0.041469816118478775, 0.03940199688076973, 0.11113376170396805, 0.024849658831954002, 0.03962913900613785, 0.010428322479128838, 0.08978477865457535, -0.008579248562455177, 0.0033965506590902805, -0.05927630141377449, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[768][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158601>
      [
        [-0.012311575002968311, 0.005543981678783894, -0.023118356242775917, -0.041668813675642014, 0.037739746272563934, 0.04817849025130272, 0.002846901537850499, -0.03284148499369621, -0.04949949309229851, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.4.attention.self.value" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158542>
      [-0.008255359716713428, -0.018463900312781334, 0.004270570352673531, -0.0025790920481085777, 0.012393001466989517, 0.023733779788017273, -0.050230663269758224, -0.005140199325978756, 0.018267998471856117, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[768][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158543>
      [
        [0.01827307976782322, 0.03337249532341957, -0.009626058861613274, 0.04123665764927864, -0.04955486208200455, 0.026140034198760986, -0.02261926978826523, 0.039593908935785294, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.11.attention.output.LayerNorm" => %{
    "beta" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158486>
      [0.064570352435112, -0.05638860911130905, 0.035961881279945374, 0.008474629372358322, -0.12924876809120178, 0.01228418666869402, -0.019327746704220772, -0.02179894968867302, ...]
    >,
    "gamma" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158487>
      [0.9312101602554321, 0.8871358633041382, 0.8806302547454834, 0.9315334558486938, 0.9046790599822998, 0.8689664006233215, 0.9133667945861816, ...]
    >
  },
  "bert.encoder.layer.10.attention.output.dense" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158472>
      [-0.05879039689898491, 0.030567845329642296, 0.07194387912750244, -0.0033002744894474745, 0.02765773981809616, -0.005126843228936195, 0.04200904071331024, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[768][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158473>
      [
        [0.06976073980331421, -0.005865570157766342, -0.00729314936324954, -0.003906785976141691, -0.008201696909964085, 0.05496169626712799, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.10.attention.output.LayerNorm" => %{
    "beta" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158470>
      [0.04313139617443085, -0.1930743306875229, 0.01064220443367958, 0.11310496181249619, -0.0028060267213732004, -0.10542047023773193, ...]
    >,
    "gamma" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158471>
      [0.9172000885009766, 0.9148061871528625, 0.892464280128479, 0.9195117354393005, 0.8759720921516418, ...]
    >
  },
  "bert.encoder.layer.6.output.LayerNorm" => %{
    "beta" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158578>
      [-0.013294342905282974, 0.0276023056358099, 0.05328423157334328, -0.07481993734836578, 0.027646636590361595, ...]
    >,
    "gamma" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158579>
      [0.9496520757675171, 0.9633301496505737, 0.9473174810409546, 0.919126033782959, ...]
    >
  },
  "bert.encoder.layer.1.attention.self.key" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158458>
      [-7.468720432370901e-4, -0.0014406130649149418, -5.631352541968226e-4, -8.530948543921113e-4, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[768][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158459>
      [
        [-0.009081468917429447, -0.014690427109599113, -0.02762993425130844, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.6.output.dense" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158580>
      [0.018838057294487953, -0.09383127093315125, -0.07344304770231247, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[3072][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158581>
      [
        [0.004912890959531069, 0.004812836181372404, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.4.attention.output.dense" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158536>
      [0.027052901685237885, 0.06410996615886688, ...]
    >,
    "kernel" => #Nx.Tensor<
      f32[768][768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158537>
      [
        [-0.04470379650592804, ...],
        ...
      ]
    >
  },
  "bert.encoder.layer.5.output.LayerNorm" => %{
    "beta" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158562>
      [-0.0017453673062846065, ...]
    >,
    "gamma" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158563>
      [...]
    >
  },
  "bert.encoder.layer.6.attention.self.query" => %{
    "bias" => #Nx.Tensor<
      f32[768]
      EXLA.Backend<host:0, 0.446408219.3911319572.158572>
      [...]
    >,
    ...
  },
  "bert.encoder.layer.2.attention.output.LayerNorm" => %{...},
  ...
}
```

## Evaluating the model

The training loop returns the final model state after training over your dataset for the given number of epochs. Axon uses the same `Axon.Loop` API to create evaluation loops as well. You can create one with the `Axon.Loop.evaluator/1` factory, instrument it with metrics, and run it on your data with your trained model state:

```elixir
logits_model
|> Axon.Loop.evaluator()
|> Axon.Loop.metric(accuracy, "accuracy")
|> Axon.Loop.run(test_data, trained_model_state)
```

<!-- livebook:{"output":true} -->

```
Batch: 49, accuracy: 0.3675000
```

<!-- livebook:{"output":true} -->

```
%{
  0 => %{
    "accuracy" => #Nx.Tensor<
      f32
      EXLA.Backend<host:0, 0.446408219.3911319572.169449>
      0.36750003695487976
    >
  }
}
```
